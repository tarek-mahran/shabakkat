<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Modern Dashboard Report Builder</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <!-- Chart.js, Chart Zoom Plugin, PapaParse, SheetJS, and Chart Financial Plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@1.2.1/dist/chartjs-plugin-zoom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
  <style>
    /* Modern Professional Dashboard Styles */
    :root {
      --primary-color: #1E88E5;
      --secondary-color: #43A047;
      --bg-color: #F4F6F8;
      --card-bg: #FFFFFF;
      --text-color: #333;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition-speed: 0.3s;
    }
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
    }
    /* Navbar */
    .navbar {
      box-shadow: 0 2px 4px var(--shadow-color);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      display: none;
    }
    .navbar-brand {
      font-weight: 500;
    }
    /* Card Styles */
    .card {
      background: var(--card-bg);
      border: none;
      border-radius: var(--border-radius);
      box-shadow: 0 2px 4px var(--shadow-color);
      margin-bottom: 20px;
    }
    .card-header {
      background: linear-gradient(135deg, var(--primary-color), #1565C0);
      color: #fff;
      border-bottom: none;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      padding: 12px 16px;
      cursor: pointer;
      font-weight: 500;
    }
    .card-footer {
      background: #f8f9fa;
      border-top: 1px solid #e9ecef;
      border-bottom-left-radius: var(--border-radius);
      border-bottom-right-radius: var(--border-radius);
      padding: 10px 16px;
    }
    /* Panels */
    #fieldsPanel, #slicersPanel {
      max-height: 250px;
      overflow-y: auto;
    }
    /* Chart Wrapper */
    .chart-wrapper {
      position: relative;
      padding: 15px;
      border-radius: var(--border-radius);
      background: var(--card-bg);
      box-shadow: 0 2px 4px var(--shadow-color);
      transition: transform var(--transition-speed);
      margin-bottom: 20px;
    }
    .chart-wrapper:hover {
      transform: translateY(-3px);
    }
    .remove-btn, .customize-colors-btn {
      position: absolute;
      top: 10px;
      z-index: 10;
    }
    .remove-btn {
      right: 10px;
    }
    .customize-colors-btn {
      right: 110px;
    }
    /* Modern Slicer Styles */
    .chart-slicer {
      background: #fff;
      border: 1px solid #d1d9e6;
      border-radius: var(--border-radius);
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      transition: transform var(--transition-speed), box-shadow var(--transition-speed);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .chart-slicer:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
    }
    .chart-slicer label {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-color);
    }
    .chart-slicer select, .chart-slicer button {
      border-radius: var(--border-radius);
    }
    .chart-slicer select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #c3cfe2;
      background: #f8f9fa;
      font-size: 0.95rem;
      transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
    }
    .chart-slicer select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.25);
    }
    .chart-slicer button {
      align-self: flex-start;
      padding: 8px 16px;
      border: none;
      background: var(--primary-color);
      color: #fff;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    .chart-slicer button:hover {
      background: #1565C0;
    }
    /* Zoom Bar */
    .zoom-bar-container {
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: var(--border-radius);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 4px var(--shadow-color);
    }
    .zoom-bar-container .input-group {
      flex: 1;
      align-items: center;
    }
    .zoom-bar-container input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      background: linear-gradient(to right, var(--primary-color), #66b2ff);
      border-radius: 4px;
      outline: none;
      transition: background 0.3s;
    }
    .zoom-bar-container input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: var(--primary-color);
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #fff;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .zoom-bar-container input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px var(--shadow-color);
    }
    .zoom-bar-container .input-group-text {
      background: transparent;
      border: none;
      font-weight: bold;
      color: var(--text-color);
    }
    .zoom-bar-container button {
      padding: 6px 12px;
      border: none;
      background: var(--primary-color);
      color: #fff;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }
    .zoom-bar-container button:hover {
      background: #1565C0;
    }
    /* Report Dashboard Grid: 2 charts per row */
    #reportCanvasContainer {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    .canvas-container {
      position: relative;
      width: 100%;
      height: 300px;
    }
    .canvas-container canvas {
      width: 100% !important;
      height: 100% !important;
    }
    /* Active Slicer Button */
    .slicer-btn.active {
      background: var(--secondary-color) !important;
      border-color: var(--primary-color) !important;
      color: #fff !important;
    }
  </style>
  <script>
    // Custom Chart.js plugin to set a background color in the chart area
    const chartAreaBgPlugin = {
      id: 'chartAreaBgPlugin',
      beforeDraw: (chart, args, options) => {
        const { ctx, chartArea: { left, top, width, height } } = chart;
        ctx.save();
        ctx.fillStyle = options.color || 'transparent';
        ctx.fillRect(left, top, width, height);
        ctx.restore();
      }
    };
    Chart.register(chartAreaBgPlugin);
    
    // Generate default colors from a preset palette
    function generateDefaultColors(n) {
      const palette = ["#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0", "#9966FF", "#FF9F40", "#66FF66", "#FF66CC"];
      let colors = [];
      for (let i = 0; i < n; i++) {
        colors.push(palette[i % palette.length]);
      }
      return colors;
    }
    
    // Helper: normalize a field value (as string)
    function normalize(value) {
      return value === undefined || value === null ? 'unknown' : value.toString().trim().toLowerCase();
    }
    
    // Helper: robustly parse a numeric value (remove commas, currency symbols, etc.)
    function parseNumber(value) {
      if (typeof value === 'number') return value;
      if (typeof value === 'string') {
        // Remove any character that is not a digit, decimal point, or minus sign.
        value = value.replace(/[^0-9.-]+/g, "");
        return parseFloat(value);
      }
      return NaN;
    }
    
    function isNumeric(n) {
      return !isNaN(parseFloat(n)) && isFinite(n);
    }
  </script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Dashboard Report Builder</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
              data-bs-target="#navbarContent" aria-controls="navbarContent" 
              aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="container-fluid">
    <div class="row mb-3">
      <!-- Left Sidebar: Fields and Global Slicers -->
      <div class="col-md-3">
        <!-- Fields Card (file upload always visible) -->
        <div class="card mb-3">
          <div class="card-header" data-bs-toggle="collapse" data-bs-target="#fieldsCollapse" aria-expanded="false" aria-controls="fieldsCollapse">
            Fields
          </div>
          <div id="fieldsCollapse" class="collapse">
            <div class="card-body" id="fieldsPanel">
              <p>No file loaded.</p>
            </div>
          </div>
          <div class="card-footer">
            <input type="file" id="fileInput" accept=".csv, .xlsx, .xls" class="form-control">
          </div>
        </div>
        <!-- Global Slicers Card (expanded by default) -->
        <div class="card">
          <div class="card-header" data-bs-toggle="collapse" data-bs-target="#slicersCollapse" aria-expanded="true" aria-controls="slicersCollapse">
            Global Slicers
          </div>
          <div id="slicersCollapse" class="collapse show">
            <div class="card-body" id="slicersPanel">
              <p>No slicers added.</p>
            </div>
            <div class="card-footer">
              <button class="btn btn-secondary btn-sm" onclick="addSlicer()">Add Slicer</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Right Panel: Visualization Settings -->
      <div class="col-md-9">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Chart Settings</h5>
          </div>
          <div class="card-body">
            <div class="accordion" id="vizAccordion">
              <!-- General Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingGeneral">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGeneral" aria-expanded="false" aria-controls="collapseGeneral">
                    <i class="bi bi-sliders me-2"></i> General
                  </button>
                </h2>
                <div id="collapseGeneral" class="accordion-collapse collapse" aria-labelledby="headingGeneral" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="chartType" class="form-label">Chart Type</label>
                      <select class="form-select" id="chartType">
                        <option value="bar">Bar</option>
                        <option value="line">Line</option>
                        <option value="pie">Pie</option>
                        <option value="doughnut">Doughnut</option>
                        <option value="radar">Radar</option>
                        <option value="polarArea">Polar Area</option>
                        <option value="bubble">Bubble</option>
                        <option value="scatter">Scatter</option>
                        <option value="stacked-bar">Stacked Bar</option>
                        <option value="mixed">Mixed</option>
                        <option value="candlestick">Candlestick</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="chartTitle" class="form-label">Chart Title</label>
                      <input type="text" class="form-control" id="chartTitle" placeholder="Enter chart title (optional)">
                    </div>
                    <div class="mb-3">
                      <label for="chartAreaBgColor" class="form-label">Chart Area Background Color</label>
                      <input type="color" class="form-control form-control-color" id="chartAreaBgColor" value="#ffffff">
                    </div>
                  </div>
                </div>
              </div>
              <!-- Data Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingData">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseData" aria-expanded="false" aria-controls="collapseData">
                    <i class="bi bi-bar-chart me-2"></i> Data
                  </button>
                </h2>
                <div id="collapseData" class="accordion-collapse collapse" aria-labelledby="headingData" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="xAxisField" class="form-label">X-Axis Field</label>
                      <select class="form-select" id="xAxisField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="yAxisField" class="form-label">Y-Axis Field</label>
                      <select class="form-select" id="yAxisField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="legendField" class="form-label">Legend Field (Optional)</label>
                      <select class="form-select" id="legendField"></select>
                    </div>
                    <div class="mb-3" id="bubbleSizeContainer" style="display: none;">
                      <label for="bubbleSizeField" class="form-label">Bubble Size Field (Optional)</label>
                      <select class="form-select" id="bubbleSizeField"></select>
                    </div>
                    <div class="mb-3" id="lineValueContainer" style="display: none;">
                      <label for="lineValueField" class="form-label">Line Value Field (Optional)</label>
                      <select class="form-select" id="lineValueField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="aggFunction" class="form-label">Aggregation Function</label>
                      <select class="form-select" id="aggFunction">
                        <option value="count">Count</option>
                        <option value="sum">Sum</option>
                        <option value="average">Average</option>
                        <option value="min">Minimum</option>
                        <option value="max">Maximum</option>
                      </select>
                      <div class="form-text">For aggregated charts (non‑scatter/bubble charts)</div>
                    </div>
                    <div class="mb-3">
                      <label for="sortOrder" class="form-label">Sort Order</label>
                      <select class="form-select" id="sortOrder">
                        <option value="None" selected>None</option>
                        <option value="Ascending">Ascending</option>
                        <option value="Descending">Descending</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="sortField" class="form-label">Sort By Field</label>
                      <select class="form-select" id="sortField">
                        <option value="aggregatedValue" selected>Aggregated Value</option>
                        <option value="xAxis">X-Axis (Label)</option>
                      </select>
                    </div>
                    <div class="mb-3 border-top pt-3">
                      <h6>Local Filter Options (Optional)</h6>
                      <div class="mb-3">
                        <label for="filterField" class="form-label">Filter Field</label>
                        <select class="form-select" id="filterField" onchange="populateFilterValuesLocal()"></select>
                      </div>
                      <div class="mb-3" id="filterValueContainerLocal" style="display: none;">
                        <label for="filterValue" class="form-label">Filter Value</label>
                        <select class="form-select" id="filterValue"></select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Format Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingFormat">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFormat" aria-expanded="false" aria-controls="collapseFormat">
                    <i class="bi bi-palette me-2"></i> Format
                  </button>
                </h2>
                <div id="collapseFormat" class="accordion-collapse collapse" aria-labelledby="headingFormat" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="datasetColor" class="form-label">Dataset Color</label>
                      <input type="color" class="form-control form-control-color" id="datasetColor" value="#36a2eb">
                    </div>
                    <div class="mb-3">
                      <label for="legendPosition" class="form-label">Legend Position</label>
                      <select class="form-select" id="legendPosition">
                        <option value="top" selected>Top</option>
                        <option value="bottom">Bottom</option>
                        <option value="left">Left</option>
                        <option value="right">Right</option>
                      </select>
                    </div>
                    <hr>
                    <h6>Dataset Settings</h6>
                    <div class="mb-3">
                      <label for="borderWidth" class="form-label">Border Width</label>
                      <input type="number" class="form-control" id="borderWidth" value="1" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="pointRadius" class="form-label">Point Radius</label>
                      <input type="number" class="form-control" id="pointRadius" value="3" min="0">
                    </div>
                    <hr>
                    <h6>Legend Settings</h6>
                    <div class="mb-3">
                      <label for="legendFontSize" class="form-label">Legend Font Size</label>
                      <input type="number" class="form-control" id="legendFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="legendFontColor" class="form-label">Legend Font Color</label>
                      <input type="color" class="form-control form-control-color" id="legendFontColor" value="#000000">
                    </div>
                    <hr>
                    <h6>Axis Settings</h6>
                    <div class="mb-3">
                      <label for="xAxisFontColor" class="form-label">X-Axis Font Color</label>
                      <input type="color" class="form-control form-control-color" id="xAxisFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="xAxisFontSize" class="form-label">X-Axis Font Size</label>
                      <input type="number" class="form-control" id="xAxisFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="yAxisFontColor" class="form-label">Y-Axis Font Color</label>
                      <input type="color" class="form-control form-control-color" id="yAxisFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="yAxisFontSize" class="form-label">Y-Axis Font Size</label>
                      <input type="number" class="form-control" id="yAxisFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3 form-check">
                      <input class="form-check-input" type="checkbox" id="showGridlines" checked>
                      <label class="form-check-label" for="showGridlines">Show Gridlines</label>
                    </div>
                    <div class="mb-3">
                      <label for="gridlineColor" class="form-label">Gridline Color</label>
                      <input type="color" class="form-control form-control-color" id="gridlineColor" value="#e0e0e0">
                    </div>
                    <hr>
                    <h6>Title Settings</h6>
                    <div class="mb-3">
                      <label for="titleFontSize" class="form-label">Title Font Size</label>
                      <input type="number" class="form-control" id="titleFontSize" value="16" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="titleFontColor" class="form-label">Title Font Color</label>
                      <input type="color" class="form-control form-control-color" id="titleFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="titleFontFamily" class="form-label">Title Font Family</label>
                      <select class="form-select" id="titleFontFamily">
                        <option value="'Roboto', sans-serif" selected>Roboto</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Times New Roman', Times, serif">Times New Roman</option>
                        <option value="'Courier New', Courier, monospace">Courier New</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <button type="button" class="btn btn-primary mt-3" onclick="addVisualization()">Add Visualization</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Report Dashboard -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">Report Dashboard</div>
          <div class="card-body" id="reportCanvasContainer">
            <p>No Charts added yet.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal for Customizing Colors -->
  <div class="modal fade" id="customColorModal" tabindex="-1" aria-labelledby="customColorModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="customColorModalLabel">Customize Value Colors</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="customColorModalBody">
          <!-- Dynamically populated color inputs -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="applyCustomColorsBtn">Apply Colors</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Scripts -->
  <script>
function D(){const a7=['inline-block','1922855tAgpgn','array','85660eCbQBe','style','canvas-container','slicerValues_','input','fields','split','yAxisFontSize','input-group-text','toggle','max','stacked','oninput','Zoom:','size','length','label','Chart\x20Filter\x20Field:','baseData','pop','Please\x20upload\x20a\x20CSV\x20or\x20Excel\x20file\x20first.','None','fileInput','35yhopyr','canvas','slice','yAxisField','multiple','sum','form-select\x20form-select-sm\x20mb-1','click','borderColor','checked','yField','line','remove','customColorModal','legendFontSize','mb-3','name','colorInput_','titleFontSize','innerText','none','innerHTML','chart-content-container','pointRadius','btn\x20btn-secondary\x20btn-sm\x20mt-1','datasetColor','display','prepend','datasets','btn\x20btn-danger\x20btn-sm\x20remove-btn','localeCompare','aggFunc','\x20(Line)','addEventListener','select','100','100%','xlsx','className','slicersPanel','onchange','radar','42dVytIT','labels','xAxisFontSize','chartAreaBgPlugin','options','slicerField_','aggregatedLabels','querySelector','scatter','getElementById','\x20canvas','read','Remove','Reset','data','4036113TlnzMv','chartWrapper_','toLowerCase','csv','titleFontColor','btn\x20btn-danger\x20btn-sm\x20ms-1','hide','classList','reduce','backgroundColor','grid','change','select[id^=\x22slicerField_\x22]','titleFontFamily','legendFontColor','push','select[id^=\x22slicerValues_\x22]','chartTitle','Customize\x20Colors','bubbleSizeContainer','color','bar','lineValueContainer','#000000','Sheets','xAxisFontColor','currentData','bubble','14BpBYKl','Unsupported\x20file\x20type.\x20Please\x20upload\x20a\x20CSV\x20or\x20Excel\x20file.','chart-slicer','.slicer-row','Show\x20Chart\x20Filter\x20Field','type','btn\x20btn-outline-primary\x20btn-sm\x20slicer-btn','customColorModalBody','selectedOptions','family','instance','legendField','responsive','legendPosition','map','scales','plugins','pie','1038900smFwSf','reportCanvasContainer','No\x20valid\x20numeric\x20data\x20found\x20for\x20the\x20selected\x20fields.','fill','form-select\x20form-select-sm','Ascending','Remove\x20Chart','btn\x20btn-secondary\x20btn-sm','chartSlicerField_','value','aggregatedColors','sortField','title','onclick','count','chartAreaBgColor','font','maintainAspectRatio','now','min','button','applyCustomColorsBtn','bubbleSizeField','target','sheet_to_json','files','chartSlicerButtonContainer_','list-group','xField','meta','option','btn\x20btn-secondary\x20btn-sm\x20customize-colors-btn','utils','polarArea','chart-wrapper','average','destroy','update','marginLeft','onload','slicer-row\x20mb-2','Hide\x20Filter\x20Field','appendChild','748zdiBwX','lineValueField','forEach','borderWidth','filterField','mixed','dataset','aggFunction','range','6106496HkpSBE','flex','span','legend','textContent','<p>No\x20fields\x20detected.</p>','sortOrder','140180HTppzX','xAxisField','sort','3410QJFMZc','gridlineColor','list-group-item','showGridlines','ticks','filter','trim','querySelectorAll','yAxisFontColor','includes','createElement','position','button.active','div','slicer_','chartType','params','keys','filterValueContainerLocal','candlestick','Modal','stacked-bar','htmlFor','block','Please\x20select\x20valid\x20X\x20and\x20Y\x20fields.','doughnut','filterValue'];D=function(){return a7;};return D();}const Jw=J;function J(a,E){const N=D();return J=function(T,o){T=T-(0x1207*0x1+0x1048+-0x2069);let x=N[T];return x;},J(a,E);}(function(a,E){const JT=J,N=a();while(!![]){try{const T=parseInt(JT(0x2a0))/(0x1345+0x82*0x1f+-0x2302)*(-parseInt(JT(0x26b))/(-0x1ed8+0x556*0x1+0x1984))+parseInt(JT(0x1f0))/(0x1*-0x1300+-0x105e+0x2361)*(-parseInt(JT(0x268))/(-0x347+-0x25a*0xa+0x1acf))+parseInt(JT(0x287))/(-0x1*-0x26d5+0x887+-0x2f57)+-parseInt(JT(0x22d))/(0xa7d+-0x146e+0x9f7)*(-parseInt(JT(0x21b))/(-0x5*0x53f+-0xc*-0x9d+0x12e6*0x1))+-parseInt(JT(0x261))/(-0x2421+0xfda*0x2+0x475)+parseInt(JT(0x1ff))/(-0xd5*0xe+-0x19b9+0x2568)+parseInt(JT(0x289))/(0x2*0x126f+0x1e*-0xe9+-0x986)*(parseInt(JT(0x258))/(-0x1*-0x1c09+-0x147d+-0x781));if(T===E)break;else N['push'](N['shift']());}catch(o){N['push'](N['shift']());}}}(D,-0x241ac*-0x2+-0xc8*-0x430+-0xf211));let csvData=[],fields=[],slicerCount=0x1*-0x14d5+-0x22b3+0x4*0xde2,chartConfigs={},currentChartWrapperIdForCustomColors=null;function trimData(E,N){const Jo=J;N=N[Jo(0x229)](o=>o[Jo(0x271)]()),E=E[Jo(0x229)](o=>{let x={};return Object['keys'](o)['forEach'](w=>{const Jx=J;x[w[Jx(0x271)]()]=o[w];}),x;});const T={};return T[Jo(0x1fe)]=E,T[Jo(0x28e)]=N,T;}document[Jw(0x1f9)](Jw(0x29f))['addEventListener'](Jw(0x20a),function(a){const JW=Jw,E=a[JW(0x244)][JW(0x246)][0x1e72+-0x151c*-0x1+-0x338e];if(!E)return;const N=E[JW(0x2b0)][JW(0x28f)]('.')[JW(0x29c)]()[JW(0x201)]();if(N===JW(0x202))Papa['parse'](E,{'complete':function(T){const JR=JW;let o=trimData(T[JR(0x1fe)],T[JR(0x24a)][JR(0x28e)]||[]);csvData=o['data'],fields=o[JR(0x28e)],populateFields(),populateDropdowns();},'header':!![]});else{if(N===JW(0x1eb)||N==='xls'){const T=new FileReader();T[JW(0x254)]=function(o){const Ji=JW,x=new Uint8Array(o['target']['result']),w={};w['type']=Ji(0x288);const W=XLSX[Ji(0x1fb)](x,w),R=W['SheetNames'][0x1c5a+-0x745+-0x15*0x101],i=W[Ji(0x217)][R],L={};L['header']=0x1;const t=XLSX[Ji(0x24d)][Ji(0x245)](i,L);let r=t[-0x23b6+0x15d2+0xde4][Ji(0x229)](b=>b[Ji(0x271)]()),m=t[Ji(0x2a2)](-0x1dc*-0xe+0x8e*-0x7+-0x1*0x1625)[Ji(0x229)](b=>{const JL=Ji;let j={};return r[JL(0x25a)]((n,y)=>{j[n]=b[y];}),j;});csvData=m,fields=r,populateFields(),populateDropdowns();},T['readAsArrayBuffer'](E);}else alert(JW(0x21c));}});function populateFields(){const Jt=Jw,a=document['getElementById']('fieldsPanel');a[Jt(0x2b5)]='';if(fields[Jt(0x298)]===-0x2208+0xcf+0x2139)a[Jt(0x2b5)]=Jt(0x266);else{const E=document[Jt(0x275)]('ul');E[Jt(0x1ec)]=Jt(0x248),fields[Jt(0x25a)](N=>{const Jr=Jt,T=document[Jr(0x275)]('li');T[Jr(0x1ec)]=Jr(0x26d),T[Jr(0x265)]=N,E['appendChild'](T);}),a[Jt(0x257)](E);}}function populateDropdowns(){const Jm=Jw,a=[Jm(0x269),Jm(0x2a3),Jm(0x226),'bubbleSizeField',Jm(0x25c),Jm(0x259)];a[Jm(0x25a)](E=>{const Jb=Jm,N=document[Jb(0x1f9)](E);N[Jb(0x2b5)]='';const T=document[Jb(0x275)]('option');T['value']='',T[Jb(0x265)]=Jb(0x29e),N[Jb(0x257)](T),fields[Jb(0x25a)](o=>{const Jj=Jb,x=document[Jj(0x275)](Jj(0x24b));x[Jj(0x236)]=o,x['textContent']=o,N['appendChild'](x['cloneNode'](!![]));});});}function populateFilterValuesLocal(){const Jn=Jw,a=document[Jn(0x1f9)]('filterField')[Jn(0x236)],E=document[Jn(0x1f9)](Jn(0x27d)),N=document['getElementById'](Jn(0x285));N[Jn(0x2b5)]='';if(!a){E[Jn(0x28a)][Jn(0x2ba)]='none';return;}const T=new Set();csvData[Jn(0x25a)](x=>{x[a]!==undefined&&x[a]!==null&&T['add'](x[a]);});const o=document[Jn(0x275)](Jn(0x24b));o[Jn(0x236)]='',o[Jn(0x265)]=Jn(0x29e),N[Jn(0x257)](o),T[Jn(0x25a)](x=>{const Jy=Jn,w=document[Jy(0x275)]('option');w[Jy(0x236)]=x,w[Jy(0x265)]=x,N[Jy(0x257)](w);}),E[Jn(0x28a)]['display']=Jn(0x282);}function addSlicer(){const JF=Jw;slicerCount++;const a=document[JF(0x1f9)](JF(0x1ed));a[JF(0x1f7)]('p')&&(a['innerHTML']='');const E=document['createElement'](JF(0x278));E[JF(0x1ec)]=JF(0x255),E['id']=JF(0x279)+slicerCount;const N=document[JF(0x275)](JF(0x1e8));N[JF(0x1ec)]=JF(0x2a6),N['id']=JF(0x1f5)+slicerCount;const T=document[JF(0x275)]('option');T[JF(0x236)]='',T['textContent']=JF(0x29e),N[JF(0x257)](T),fields[JF(0x25a)](w=>{const JU=JF,W=document[JU(0x275)](JU(0x24b));W['value']=w,W[JU(0x265)]=w,N['appendChild'](W);}),N[JF(0x1ee)]=function(){updateSlicerValues(E['id']);},E[JF(0x257)](N);const o=document[JF(0x275)](JF(0x1e8));o[JF(0x1ec)]=JF(0x231),o['id']='slicerValues_'+slicerCount,o[JF(0x2a4)]=!![],o[JF(0x28a)][JF(0x2ba)]=JF(0x2b4),E[JF(0x257)](o);const x=document[JF(0x275)](JF(0x241));x['type']=JF(0x241),x[JF(0x1ec)]=JF(0x204),x[JF(0x2b3)]=JF(0x1fc),x[JF(0x23a)]=function(){const Js=JF;E[Js(0x2ac)]();},E[JF(0x257)](x),a['appendChild'](E);}function updateSlicerValues(a){const JC=Jw,E=a['split']('_')[-0x1*-0x1439+-0x45*0x3+-0x1*0x1369],N=document[JC(0x1f9)](JC(0x1f5)+E),T=document[JC(0x1f9)](JC(0x28c)+E);T[JC(0x2b5)]='';if(!N[JC(0x236)]){T[JC(0x28a)][JC(0x2ba)]='none';return;}const o=new Set();csvData[JC(0x25a)](x=>{const JG=JC;x[N[JG(0x236)]]!==undefined&&x[N[JG(0x236)]]!==null&&o['add'](x[N[JG(0x236)]]);}),o['forEach'](x=>{const Jc=JC,w=document['createElement'](Jc(0x24b));w[Jc(0x236)]=x,w['textContent']=x,T['appendChild'](w);}),T['style']['display']=JC(0x282);}function updateSlicerButtons(a,E,N,T){const JI=Jw,o=document[JI(0x1f9)]('chartSlicerButtonContainer_'+a);o[JI(0x2b5)]='';if(!N){o[JI(0x28a)][JI(0x2ba)]='none';return;}let x=new Set();E[JI(0x25a)](w=>{w[N]!==undefined&&w[N]!==null&&x['add'](w[N]);}),x[JI(0x25a)](w=>{const JB=JI;let W=document['createElement'](JB(0x241));W[JB(0x220)]=JB(0x241),W[JB(0x1ec)]=JB(0x221),W[JB(0x2b3)]=w,W[JB(0x25e)][JB(0x236)]=w,W[JB(0x23a)]=function(){const JO=JB;W[JO(0x206)][JO(0x292)]('active');},o[JB(0x257)](W);}),o[JI(0x28a)][JI(0x2ba)]=JI(0x282);}function applyChartSlicer(a){const Jl=Jw;let E=a[Jl(0x28f)]('_')[-0x3*-0x16a+0x23e5+-0x2822];const N=document[Jl(0x1f9)](Jl(0x235)+E),T=document[Jl(0x1f9)](Jl(0x247)+E);let o=[];if(T){const t=T['querySelectorAll'](Jl(0x277));t[Jl(0x25a)](r=>{const JZ=Jl;o[JZ(0x20e)](r[JZ(0x25e)]['value']);});}let x=chartConfigs[a];if(!x)return;let w=x[Jl(0x27b)],W=w['baseData'];N['value']&&o[Jl(0x298)]>0x683*-0x4+-0x2659+0x4065&&(W=W[Jl(0x270)](r=>o['includes'](r[N[Jl(0x236)]])));let R=rebuildChartConfig(w,W);x[Jl(0x225)][Jl(0x251)]();const i=document[Jl(0x1f7)]('#'+a+Jl(0x1fa));let L=new Chart(i,R);x[Jl(0x225)]=L,x[Jl(0x27b)][Jl(0x219)]=W;}function rebuildChartConfig(b,j){const Je=Jw;let n={};if(b[Je(0x27a)]===Je(0x1f8)||b['chartType']===Je(0x21a)){let y=[];j[Je(0x25a)](s=>{const Jf=Je,C=parseFloat(s[b[Jf(0x249)]]),G=parseFloat(s[b[Jf(0x2aa)]]);if(isNumeric(C)&&isNumeric(G)){if(b[Jf(0x27a)]==='bubble'){let c=0x3c1+-0x1127*-0x1+-0x14e3*0x1;b['bubbleSizeField']&&s[b['bubbleSizeField']]&&isNumeric(s[b['bubbleSizeField']])&&(c=parseFloat(s[b[Jf(0x243)]]));const I={};I['x']=C,I['y']=G,I['r']=c,y['push'](I);}else{const B={};B['x']=C,B['y']=G,y[Jf(0x20e)](B);}}});const F={};F[Je(0x2ba)]=![];const U={};U[Je(0x220)]=b[Je(0x27a)],U[Je(0x1fe)]={},U[Je(0x1f4)]={},U[Je(0x1fe)][Je(0x2bc)]=[{'label':b[Je(0x210)],'data':y,'backgroundColor':b[Je(0x2b9)],'borderColor':b['datasetColor'],'borderWidth':b[Je(0x25b)],'pointRadius':b[Je(0x2b7)]}],U[Je(0x1f4)]['responsive']=!![],U[Je(0x1f4)][Je(0x23e)]=![],U[Je(0x1f4)][Je(0x22b)]={},U[Je(0x1f4)][Je(0x22b)][Je(0x1f3)]={},U[Je(0x1f4)][Je(0x22b)]['title']=b[Je(0x210)]?{'display':!![],'text':b[Je(0x210)],'font':{'size':b[Je(0x2b2)],'family':b[Je(0x20c)]},'color':b[Je(0x203)]}:F,U[Je(0x1f4)][Je(0x22b)][Je(0x264)]={},U[Je(0x1f4)][Je(0x22b)][Je(0x1f3)][Je(0x213)]=b[Je(0x23c)],U[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x276)]=b['legendPosition'],U[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)]={},U[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)][Je(0x23d)]={},U[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)]['color']=b[Je(0x20d)],U[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)][Je(0x23d)][Je(0x297)]=b[Je(0x2ae)],n=U;}else{let s={};b['aggFunc']===Je(0x23b)?j[Je(0x25a)](B=>{const O=normalize(B[b['xField']]);if(!s[O])s[O]=-0x3e*-0x43+0x3f8+0x1*-0x1432;s[O]++;}):j[Je(0x25a)](B=>{const Jg=Je,O=normalize(B[b['xField']]),l=parseFloat(B[b[Jg(0x2aa)]]);if(isNumeric(l)){if(!s[O])s[O]=[];s[O]['push'](l);}});let C=Object[Je(0x27c)](s),G=C[Je(0x229)](B=>{const JX=Je;if(b[JX(0x2bf)]===JX(0x23b))return s[B];else{if(b[JX(0x2bf)]===JX(0x2a5))return s[B][JX(0x207)]((O,l)=>O+l,-0x233a+0x2*-0x824+-0x3382*-0x1);else{if(b[JX(0x2bf)]===JX(0x250)){const O=s[B];return O[JX(0x207)]((l,Z)=>l+Z,-0x7ef*-0x2+0x2cf*-0x9+-0x1*-0x969)/O['length'];}else{if(b['aggFunc']===JX(0x240))return Math[JX(0x240)](...s[B]);else{if(b[JX(0x2bf)]==='max')return Math[JX(0x293)](...s[B]);else return s[B];}}}}});b['aggregatedColors']=generateDefaultColors(C[Je(0x298)]);const c={};c[Je(0x2ba)]=![];const I={};I[Je(0x220)]=b[Je(0x27a)]===Je(0x25d)?Je(0x214):b[Je(0x27a)],I[Je(0x1fe)]={},I[Je(0x1f4)]={},I[Je(0x1fe)][Je(0x1f1)]=C,I[Je(0x1fe)][Je(0x2bc)]=[{'label':b[Je(0x249)]+'\x20('+b['aggFunc']+')','data':G,'backgroundColor':b['aggregatedColors'],'borderColor':b[Je(0x237)],'borderWidth':b[Je(0x25b)],'pointRadius':b[Je(0x2b7)]}],I[Je(0x1f4)]['responsive']=!![],I[Je(0x1f4)]['maintainAspectRatio']=![],I[Je(0x1f4)][Je(0x22b)]={},I[Je(0x1f4)][Je(0x22b)][Je(0x1f3)]={},I[Je(0x1f4)][Je(0x22b)][Je(0x239)]=b[Je(0x210)]?{'display':!![],'text':b[Je(0x210)],'font':{'size':b[Je(0x2b2)],'family':b[Je(0x20c)]},'color':b[Je(0x203)]}:c,I[Je(0x1f4)][Je(0x22b)][Je(0x264)]={},I[Je(0x1f4)][Je(0x22b)][Je(0x1f3)][Je(0x213)]=b[Je(0x23c)],I[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x276)]=b[Je(0x228)],I[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)]={},I[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)][Je(0x23d)]={},I[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)]['color']=b[Je(0x20d)],I[Je(0x1f4)][Je(0x22b)][Je(0x264)][Je(0x1f1)][Je(0x23d)][Je(0x297)]=b['legendFontSize'],n=I;if(b[Je(0x27a)]===Je(0x25d)){const B=b['lineValueField'];let O=[];B?O=C[Je(0x229)](g=>{const Jz=Je,X=j[Jz(0x270)](z=>normalize(z[b[Jz(0x249)]])===g);if(b[Jz(0x2bf)]===Jz(0x23b))return X['filter'](z=>{let S=parseNumber(z[B]);return!isNaN(S);})[Jz(0x298)];else{if(b['aggFunc']===Jz(0x2a5))return X['reduce']((z,S)=>{let u=parseNumber(S[B]);return z+(isNaN(u)?0x6d2+-0x4e1*0x3+0x17*0x57:u);},0x248a+0xda*0x19+0x1cea*-0x2);else{if(b[Jz(0x2bf)]==='average'){const z=X[Jz(0x229)](S=>parseNumber(S[B]))[Jz(0x270)](S=>!isNaN(S));return z[Jz(0x298)]?z[Jz(0x207)]((S,u)=>S+u,0x2511+-0xaa5+-0x1a6c)/z[Jz(0x298)]:-0x365+-0x254f*-0x1+0x2*-0x10f5;}else{if(b[Jz(0x2bf)]===Jz(0x240)){const S=X[Jz(0x229)](u=>parseNumber(u[B]))['filter'](u=>!isNaN(u));return S[Jz(0x298)]?Math[Jz(0x240)](...S):0xe3d+0x1*-0x118b+0x34e;}else{if(b['aggFunc']===Jz(0x293)){const u=X[Jz(0x229)](V=>parseNumber(V[B]))[Jz(0x270)](V=>!isNaN(V));return u[Jz(0x298)]?Math[Jz(0x293)](...u):-0x1758+-0x1612+0x2d6a;}else return null;}}}}}):O=G;const l={};l[Je(0x220)]=Je(0x2ab),l[Je(0x299)]=B?B:b[Je(0x249)]+Je(0x1e6),l[Je(0x1fe)]=O,l['borderColor']=Je(0x216),l['fill']=![],l[Je(0x25b)]=b['borderWidth'],l[Je(0x2b7)]=b['pointRadius'],n['data'][Je(0x2bc)][Je(0x20e)](l);const Z={};Z['stacked']=![];const e={};e[Je(0x294)]=![];const f={};f['x']=Z,f['y']=e,n[Je(0x1f4)][Je(0x22a)]=f;}if(![Je(0x22c),Je(0x284),Je(0x24e),Je(0x1ef)][Je(0x274)](b['chartType'])){const g={};g[Je(0x213)]=b[Je(0x218)],g[Je(0x23d)]={},g[Je(0x23d)]['size']=b[Je(0x1f2)];const X={};X['display']=b['showGridlines'],X['color']=b[Je(0x26c)];const z={};z['ticks']=g,z[Je(0x209)]=X;const S={};S['color']=b[Je(0x273)],S[Je(0x23d)]={},S[Je(0x23d)]['size']=b[Je(0x290)];const u={};u[Je(0x2ba)]=b[Je(0x26e)],u[Je(0x213)]=b['gridlineColor'];const V={};V[Je(0x26f)]=S,V['grid']=u,n[Je(0x1f4)][Je(0x22a)]={...n[Je(0x1f4)]['scales'],'x':z,'y':V};}}return n;}document[Jw(0x1f9)](Jw(0x27a))['addEventListener'](Jw(0x20a),function(){const JS=Jw,a=this[JS(0x236)];document[JS(0x1f9)](JS(0x212))[JS(0x28a)][JS(0x2ba)]=a==='bubble'?'block':'none',document[JS(0x1f9)](JS(0x215))[JS(0x28a)]['display']=a===JS(0x25d)?JS(0x282):JS(0x2b4);});function openCustomColorModal(a){const Ju=Jw;currentChartWrapperIdForCustomColors=a;const E=chartConfigs[a]['params'];if(!E[Ju(0x1f6)]||!E['aggregatedColors']){alert('This\x20chart\x20type\x20does\x20not\x20support\x20individual\x20value\x20color\x20customization.');return;}const N=document[Ju(0x1f9)](Ju(0x222));N[Ju(0x2b5)]='',E[Ju(0x1f6)]['forEach']((x,w)=>{const JV=Ju,W=document[JV(0x275)](JV(0x278));W[JV(0x1ec)]=JV(0x2af);const R=document[JV(0x275)](JV(0x299));R['className']='form-label',R['innerText']=x,R[JV(0x281)]=JV(0x2b1)+w;const i=document[JV(0x275)]('input');i[JV(0x220)]=JV(0x213),i['className']='form-control\x20form-control-color',i['id']=JV(0x2b1)+w,i[JV(0x236)]=E[JV(0x237)][w]||JV(0x216),W[JV(0x257)](R),W[JV(0x257)](i),N['appendChild'](W);});const T=document[Ju(0x1f9)](Ju(0x2ad)),o=new bootstrap['Modal'](T);o['show']();}document['getElementById'](Jw(0x242))[Jw(0x1e7)](Jw(0x2a7),function(){const JP=Jw;if(!currentChartWrapperIdForCustomColors)return;const a=chartConfigs[currentChartWrapperIdForCustomColors][JP(0x27b)],E=[];a[JP(0x1f6)][JP(0x25a)]((x,w)=>{const JK=JP,W=document[JK(0x1f9)](JK(0x2b1)+w);W&&E['push'](W[JK(0x236)]);}),a[JP(0x237)]=E;const N=chartConfigs[currentChartWrapperIdForCustomColors][JP(0x225)];N['data']['datasets']&&N[JP(0x1fe)][JP(0x2bc)][JP(0x298)]>-0x3*-0x6da+-0x11*0xbb+-0x823*0x1&&(N[JP(0x1fe)][JP(0x2bc)][-0x18b0+-0x261+0x1b11][JP(0x208)]=E,N['data'][JP(0x2bc)][0x709*-0x1+0x2003+-0x18fa]['borderColor']=E);N['update']();const T=document[JP(0x1f9)](JP(0x2ad)),o=bootstrap[JP(0x27f)]['getInstance'](T);o[JP(0x205)]();});function addVisualization(){const Jd=Jw;if(csvData[Jd(0x298)]===-0x1f06+-0x14f6+0x33fc){alert(Jd(0x29d));return;}const f=document['getElementById'](Jd(0x210))[Jd(0x236)],g=document[Jd(0x1f9)]('chartType')[Jd(0x236)],X=document[Jd(0x1f9)](Jd(0x269))[Jd(0x236)],z=document['getElementById'](Jd(0x2a3))['value'];if(!X||!z){alert(Jd(0x283));return;}const S=document[Jd(0x1f9)]('bubbleSizeField')['value'],u=document['getElementById'](Jd(0x25f))[Jd(0x236)],V=document[Jd(0x1f9)]('sortOrder')['value'],P=document[Jd(0x1f9)]('sortField')[Jd(0x236)],K=document[Jd(0x1f9)](Jd(0x23c))[Jd(0x236)],d=document[Jd(0x1f9)](Jd(0x2b9))[Jd(0x236)],A=document['getElementById'](Jd(0x228))['value'],p=parseInt(document[Jd(0x1f9)]('borderWidth')['value'])||0x1222*-0x1+0x2604+-0x13e1,h=parseInt(document[Jd(0x1f9)]('pointRadius')[Jd(0x236)])||0x214*-0x8+-0xceb+0x123*0x1a,Q=parseInt(document[Jd(0x1f9)]('legendFontSize')['value'])||0x1*0x952+-0x90d+-0x39*0x1,M=document[Jd(0x1f9)](Jd(0x20d))[Jd(0x236)],H=document[Jd(0x1f9)]('xAxisFontColor')[Jd(0x236)],v=parseInt(document['getElementById']('xAxisFontSize')[Jd(0x236)])||-0x197b+0x437*0x5+0x474,q=document['getElementById'](Jd(0x273))['value'],Y=parseInt(document['getElementById'](Jd(0x290))[Jd(0x236)])||0x44a*-0x3+0x2520+0x409*-0x6,k=document[Jd(0x1f9)](Jd(0x26e))[Jd(0x2a9)],D0=document['getElementById']('gridlineColor')[Jd(0x236)],D1=parseInt(document['getElementById']('titleFontSize')[Jd(0x236)])||-0x485*-0x7+0x1a1+-0x2134,D2=document[Jd(0x1f9)]('titleFontColor')[Jd(0x236)],D3=document[Jd(0x1f9)]('titleFontFamily')[Jd(0x236)],D4=document['getElementById'](Jd(0x259))[Jd(0x236)][Jd(0x271)]();let D5=csvData;const D6=document['getElementById'](Jd(0x25c))[Jd(0x236)],D7=document['getElementById']('filterValue')['value'];D6&&D7&&(D5=D5[Jd(0x270)](Dm=>Dm[D6]==D7));const D8=document['getElementById'](Jd(0x1ed)),D9=D8[Jd(0x272)](Jd(0x21e));D9[Jd(0x25a)](Dm=>{const JA=Jd,Db=Dm['querySelector'](JA(0x20b))[JA(0x236)],Dj=Dm[JA(0x1f7)](JA(0x20f));if(Db&&Dj['selectedOptions'][JA(0x298)]>0xb*0x1f2+-0x1801+0x1*0x29b){let Dn=[];for(let Dy of Dj[JA(0x223)]){Dn[JA(0x20e)](Dy[JA(0x236)]);}D5=D5[JA(0x270)](DF=>Dn[JA(0x274)](DF[Db]));}});let DD=D5[Jd(0x2a2)](),DJ={};if(g===Jd(0x1f8)||g===Jd(0x21a)){let Dm=[];D5[Jd(0x25a)](DB=>{const Jp=Jd,DO=parseFloat(DB[X]),Dl=parseFloat(DB[z]);if(isNumeric(DO)&&isNumeric(Dl)){if(g===Jp(0x21a)){let DZ=0xe5c+-0x1f*-0xd6+0xf*-0x2af;S&&DB[S]&&isNumeric(DB[S])&&(DZ=parseFloat(DB[S]));const De={};De['x']=DO,De['y']=Dl,De['r']=DZ,Dm[Jp(0x20e)](De);}else{const Df={};Df['x']=DO,Df['y']=Dl,Dm['push'](Df);}}});if(Dm[Jd(0x298)]===-0x9*-0x367+-0xa*0x159+-0xe7*0x13){alert(Jd(0x22f));return;}const Db={};Db[Jd(0x299)]=f,Db[Jd(0x1fe)]=Dm,Db[Jd(0x208)]=d,Db[Jd(0x2a8)]=d,Db[Jd(0x25b)]=p,Db['pointRadius']=h;const Dj={};Dj[Jd(0x2bc)]=[Db];const Dn={};Dn['color']=K;const Dy={};Dy[Jd(0x297)]=D1,Dy[Jd(0x224)]=D3;const DF={};DF[Jd(0x2ba)]=![];const DU={};DU['size']=Q;const Ds={};Ds[Jd(0x23d)]=DU,Ds[Jd(0x213)]=M;const DC={};DC[Jd(0x276)]=A,DC[Jd(0x1f1)]=Ds;const DG={};DG[Jd(0x1f3)]=Dn,DG['title']=f?{'display':!![],'text':f,'font':Dy,'color':D2}:DF,DG['legend']=DC;const Dc={};Dc[Jd(0x227)]=!![],Dc[Jd(0x23e)]=![],Dc[Jd(0x22b)]=DG;const DI={};DI[Jd(0x220)]=g,DI[Jd(0x1fe)]=Dj,DI['options']=Dc,DJ=DI;}else{let DB={};u===Jd(0x23b)?D5[Jd(0x25a)](DA=>{const Dp=normalize(DA[X]);if(!DB[Dp])DB[Dp]=-0x1ff2+0x941+-0x25*-0x9d;DB[Dp]++;}):D5['forEach'](DA=>{const Jh=Jd,Dp=normalize(DA[X]),Dh=parseFloat(DA[z]);if(isNumeric(Dh)){if(!DB[Dp])DB[Dp]=[];DB[Dp][Jh(0x20e)](Dh);}});let DO=Object[Jd(0x27c)](DB),Dl=DO[Jd(0x229)](DA=>{const JQ=Jd;if(u===JQ(0x23b))return DB[DA];else{if(u==='sum')return DB[DA][JQ(0x207)]((Dp,Dh)=>Dp+Dh,-0x4c*-0x31+-0x152+-0xd3a);else{if(u===JQ(0x250)){const Dp=DB[DA];return Dp[JQ(0x207)]((Dh,DQ)=>Dh+DQ,0x1*-0x1c8b+0xfc0+-0x83*-0x19)/Dp[JQ(0x298)];}else{if(u===JQ(0x240))return Math[JQ(0x240)](...DB[DA]);else{if(u===JQ(0x293))return Math['max'](...DB[DA]);else return DB[DA];}}}}}),DZ=generateDefaultColors(DO[Jd(0x298)]);const De={};De[Jd(0x299)]=X+'\x20('+u+')',De['data']=Dl,De[Jd(0x208)]=DZ,De[Jd(0x2a8)]=DZ,De[Jd(0x25b)]=p,De[Jd(0x2b7)]=h;const Df={};Df['labels']=DO,Df[Jd(0x2bc)]=[De];const Dg={};Dg[Jd(0x213)]=K;const DX={};DX[Jd(0x297)]=D1,DX[Jd(0x224)]=D3;const Dz={};Dz[Jd(0x2ba)]=![];const DS={};DS[Jd(0x297)]=Q;const Du={};Du[Jd(0x23d)]=DS,Du[Jd(0x213)]=M;const DV={};DV[Jd(0x276)]=A,DV['labels']=Du;const DP={};DP[Jd(0x1f3)]=Dg,DP[Jd(0x239)]=f?{'display':!![],'text':f,'font':DX,'color':D2}:Dz,DP[Jd(0x264)]=DV;const DK={};DK[Jd(0x227)]=!![],DK['maintainAspectRatio']=![],DK[Jd(0x22b)]=DP;const Dd={};Dd[Jd(0x220)]=g===Jd(0x25d)?'bar':g,Dd['data']=Df,Dd[Jd(0x1f4)]=DK,DJ=Dd;if(g===Jd(0x25d)){let DA=[];D4?DA=DO['map'](DH=>{const JM=Jd,Dv=D5[JM(0x270)](Dq=>normalize(Dq[X])===DH);if(u==='count')return Dv[JM(0x270)](Dq=>{let DY=parseNumber(Dq[D4]);return!isNaN(DY);})[JM(0x298)];else{if(u==='sum')return Dv[JM(0x207)]((Dq,DY)=>{let Dk=parseNumber(DY[D4]);return Dq+(isNaN(Dk)?-0x1a3e*0x1+-0x3fc+0x1e3a:Dk);},-0x1f*-0xb3+-0x8a*0x47+0x1099);else{if(u===JM(0x250)){const Dq=Dv[JM(0x229)](DY=>parseNumber(DY[D4]))['filter'](DY=>!isNaN(DY));return Dq[JM(0x298)]?Dq[JM(0x207)]((DY,Dk)=>DY+Dk,-0x5*-0x33f+0x1*0x1897+0x26*-0x113)/Dq[JM(0x298)]:-0xd*0x2b8+-0x2419*0x1+0x4771;}else{if(u===JM(0x240)){const DY=Dv[JM(0x229)](Dk=>parseNumber(Dk[D4]))[JM(0x270)](Dk=>!isNaN(Dk));return DY[JM(0x298)]?Math[JM(0x240)](...DY):-0x1046+-0x1486+-0x4*-0x933;}else{if(u===JM(0x293)){const Dk=Dv['map'](J0=>parseNumber(J0[D4]))['filter'](J0=>!isNaN(J0));return Dk['length']?Math[JM(0x293)](...Dk):0x67b+-0x216c+0x1af1;}else return null;}}}}}):DA=Dl;const Dp={};Dp[Jd(0x220)]='line',Dp[Jd(0x299)]=D4?D4:X+Jd(0x1e6),Dp[Jd(0x1fe)]=DA,Dp[Jd(0x2a8)]=Jd(0x216),Dp[Jd(0x230)]=![],Dp['borderWidth']=p,Dp[Jd(0x2b7)]=h,DJ[Jd(0x1fe)]['datasets'][Jd(0x20e)](Dp);const Dh={};Dh['stacked']=![];const DQ={};DQ['stacked']=![];const DM={};DM['x']=Dh,DM['y']=DQ,DJ[Jd(0x1f4)][Jd(0x22a)]=DM;}}const Da=document[Jd(0x1f9)](Jd(0x22e));Da[Jd(0x1f7)]('p')&&(Da[Jd(0x2b5)]='');const DE=Date[Jd(0x23f)](),DN=document[Jd(0x275)](Jd(0x278));DN[Jd(0x1ec)]=Jd(0x24f),DN['id']=Jd(0x200)+DE;const DT=document['createElement'](Jd(0x241));DT[Jd(0x2b3)]=Jd(0x233),DT[Jd(0x1ec)]=Jd(0x2bd),DT[Jd(0x23a)]=function(){const JH=Jd;DN[JH(0x2ac)](),delete chartConfigs[DN['id']];},DN[Jd(0x257)](DT);if(g!=='scatter'&&g!==Jd(0x21a)){const DH=document[Jd(0x275)](Jd(0x241));DH[Jd(0x2b3)]=Jd(0x211),DH[Jd(0x1ec)]=Jd(0x24c),DH['onclick']=function(){openCustomColorModal(DN['id']);},DN[Jd(0x257)](DH);const Dv=document[Jd(0x275)](Jd(0x278));Dv[Jd(0x1ec)]=Jd(0x21d),Dv['style'][Jd(0x2ba)]=Jd(0x2b4);const Dq=document[Jd(0x275)](Jd(0x299));Dq['innerText']=Jd(0x29a),Dv[Jd(0x257)](Dq);const DY=document['createElement'](Jd(0x1e8));DY[Jd(0x1ec)]=Jd(0x231),DY['id']=Jd(0x235)+DE;const Dk=document['createElement']('option');Dk[Jd(0x236)]='',Dk[Jd(0x265)]=Jd(0x29e),DY[Jd(0x257)](Dk),fields[Jd(0x25a)](J4=>{const Jv=Jd,J5=document[Jv(0x275)](Jv(0x24b));J5['value']=J4,J5[Jv(0x265)]=J4,DY[Jv(0x257)](J5);}),Dv[Jd(0x257)](DY);const J0=document[Jd(0x275)]('div');J0['id']=Jd(0x247)+DE,J0[Jd(0x28a)][Jd(0x2ba)]=Jd(0x2b4),Dv[Jd(0x257)](J0),DY[Jd(0x1ee)]=function(){const Jq=Jd;let J4=DY[Jq(0x236)];updateSlicerButtons(DE,chartConfigs[DN['id']]['params'][Jq(0x29b)],J4,DN['id']);};const J1=document[Jd(0x275)](Jd(0x241));J1[Jd(0x220)]=Jd(0x241),J1[Jd(0x1ec)]=Jd(0x2b8),J1['innerText']='Apply\x20Chart\x20Filter',J1[Jd(0x23a)]=function(){applyChartSlicer(DN['id']);},Dv['appendChild'](J1);const J2=document[Jd(0x275)](Jd(0x241));J2['type']='button',J2['className']=Jd(0x2b8),J2[Jd(0x2b3)]=Jd(0x256),J2[Jd(0x23a)]=function(){const JY=Jd;Dv[JY(0x28a)][JY(0x2ba)]=JY(0x2b4),J3[JY(0x28a)][JY(0x2ba)]=JY(0x286);},Dv[Jd(0x257)](J2);const J3=document['createElement'](Jd(0x241));J3['innerText']=Jd(0x21f),J3[Jd(0x1ec)]=Jd(0x234),J3['style'][Jd(0x253)]='5px',J3['onclick']=function(){const Jk=Jd;Dv[Jk(0x28a)][Jk(0x2ba)]='block',J3[Jk(0x28a)]['display']=Jk(0x2b4),DN[Jk(0x2bb)](Dv);},DN['appendChild'](J3),DN['prepend'](Dv);}const Do=document[Jd(0x275)](Jd(0x278));Do[Jd(0x1ec)]=Jd(0x2b6);const Dx=document[Jd(0x275)]('div');Dx['className']=Jd(0x28b);const Dw=document[Jd(0x275)](Jd(0x2a1));Dx[Jd(0x257)](Dw);if([Jd(0x214),'pie','doughnut',Jd(0x280),Jd(0x25d),Jd(0x1ef),Jd(0x24e),Jd(0x27e)][Jd(0x274)](g)){let J4=document[Jd(0x275)]('div');J4['className']='zoom-bar-container';const J5=document[Jd(0x275)](Jd(0x278));J5[Jd(0x1ec)]='input-group';const J6=document[Jd(0x275)](Jd(0x263));J6[Jd(0x1ec)]=Jd(0x291),J6['innerText']=Jd(0x296),J5[Jd(0x257)](J6);const J7=document[Jd(0x275)](Jd(0x28d));J7[Jd(0x220)]=Jd(0x260),J7[Jd(0x240)]='1',J7['max']='100',J7[Jd(0x236)]=Jd(0x1e9),J7['className']='form-range',J7[Jd(0x28a)][Jd(0x262)]='1';const J8=document[Jd(0x275)](Jd(0x263));J8['className']=Jd(0x291),J8[Jd(0x2b3)]=Jd(0x1ea),J7[Jd(0x295)]=function(){const a0=Jd;let JD=parseInt(J7[a0(0x236)]);J8['innerText']=JD+'%',updateZoom(DN['id'],JD);},J5[Jd(0x257)](J7),J5[Jd(0x257)](J8),J4[Jd(0x257)](J5);const J9=document[Jd(0x275)]('button');J9['type']=Jd(0x241),J9[Jd(0x1ec)]=Jd(0x234),J9[Jd(0x2b3)]=Jd(0x1fd),J9[Jd(0x23a)]=function(){const a1=Jd;J7['value']=a1(0x1e9),J8[a1(0x2b3)]=a1(0x1ea),updateZoom(DN['id'],-0xe5d+0x191*-0x1+0x1052);},J4[Jd(0x257)](J9),Do[Jd(0x257)](Dx),Do[Jd(0x257)](J4);}else Do['appendChild'](Dx);DN['appendChild'](Do),Da[Jd(0x257)](DN);const DW={};DW[Jd(0x213)]=K;const DR={...DJ};DR[Jd(0x1f4)]={...DJ['options']},DR[Jd(0x1f4)][Jd(0x227)]=!![],DR[Jd(0x1f4)][Jd(0x23e)]=![],DR[Jd(0x1f4)][Jd(0x22b)]={...DJ[Jd(0x1f4)][Jd(0x22b)]},DR[Jd(0x1f4)][Jd(0x22b)][Jd(0x1f3)]=DW;let Di=new Chart(Dw,DR);const DL={};DL[Jd(0x27a)]=g,DL[Jd(0x249)]=X,DL[Jd(0x2aa)]=z,DL['aggFunc']=u,DL[Jd(0x243)]=S,DL[Jd(0x210)]=f,DL[Jd(0x23c)]=K,DL[Jd(0x29b)]=D5,DL['currentData']=D5,DL['datasetColor']=d,DL[Jd(0x228)]=A,DL[Jd(0x25b)]=p,DL[Jd(0x2b7)]=h,DL['legendFontSize']=Q,DL[Jd(0x20d)]=M,DL[Jd(0x218)]=H,DL[Jd(0x1f2)]=v,DL['yAxisFontColor']=q,DL['yAxisFontSize']=Y,DL['showGridlines']=k,DL['gridlineColor']=D0,DL[Jd(0x2b2)]=D1,DL[Jd(0x203)]=D2,DL[Jd(0x20c)]=D3,DL[Jd(0x259)]=D4;let Dt=DL;if(g!=='scatter'&&g!==Jd(0x21a)){let JD={};u===Jd(0x23b)?D5[Jd(0x25a)](Ja=>{const JE=normalize(Ja[X]);if(!JD[JE])JD[JE]=-0x99b+0x223+0x778;JD[JE]++;}):D5['forEach'](Ja=>{const a2=Jd,JE=normalize(Ja[X]),JN=parseFloat(Ja[z]);if(isNumeric(JN)){if(!JD[JE])JD[JE]=[];JD[JE][a2(0x20e)](JN);}});let JJ=Object[Jd(0x27c)](JD);Dt[Jd(0x1f6)]=JJ,Dt[Jd(0x237)]=generateDefaultColors(JJ['length']);}const Dr={};Dr[Jd(0x225)]=Di,Dr['params']=Dt,chartConfigs[DN['id']]=Dr;}function updateZoom(a,E){const a3=Jw;let N=chartConfigs[a];if(!N)return;let T=N[a3(0x27b)],o={};T[a3(0x2bf)]==='count'?T[a3(0x29b)][a3(0x25a)](t=>{const a4=a3,r=normalize(t[T[a4(0x249)]]);if(!o[r])o[r]=-0x599*0x6+0x5e*0x25+-0x14*-0x100;o[r]++;}):T['baseData'][a3(0x25a)](t=>{const a5=a3,r=normalize(t[T[a5(0x249)]]),m=parseFloat(t[T[a5(0x2aa)]]);if(isNumeric(m)){if(!o[r])o[r]=[];o[r]['push'](m);}});let x=Object[a3(0x27c)](o),w=x[a3(0x229)](t=>{const a6=a3;if(T[a6(0x2bf)]===a6(0x23b))return o[t];else{if(T['aggFunc']===a6(0x2a5))return o[t][a6(0x207)]((r,m)=>r+m,-0x1f27+-0xa87+0x29ae);else{if(T['aggFunc']==='average'){const r=o[t];return r[a6(0x207)]((m,j)=>m+j,-0x25c1+-0xb37+0x30f8)/r[a6(0x298)];}else{if(T['aggFunc']==='min')return Math['min'](...o[t]);else{if(T[a6(0x2bf)]===a6(0x293))return Math[a6(0x293)](...o[t]);else return o[t];}}}}});if(T[a3(0x267)]&&T[a3(0x267)]!=='None'){let t=x['map']((r,m)=>({'label':r,'value':w[m]}));if(T['sortField']==='aggregatedValue')t[a3(0x26a)]((r,m)=>T[a3(0x267)]==='Ascending'?r['value']-m[a3(0x236)]:m[a3(0x236)]-r[a3(0x236)]);else T[a3(0x238)]==='xAxis'&&t[a3(0x26a)]((r,m)=>T[a3(0x267)]===a3(0x232)?r[a3(0x299)][a3(0x2be)](m[a3(0x299)]):m[a3(0x299)][a3(0x2be)](r[a3(0x299)]));x=t[a3(0x229)](r=>r[a3(0x299)]),w=t['map'](r=>r['value']);}let W=Math['ceil'](x[a3(0x298)]*E/(0x24cb*0x1+0xbc*0x18+-0x3607));W=W<0x11f6+0x17f9*0x1+0x2*-0x14f7?-0x1*-0x589+-0x2*0x6fb+0x86e:W;let R=x[a3(0x2a2)](-0x1ade+-0x1f20+0x39fe,W),i=w[a3(0x2a2)](0x1e39+0x1*-0xd12+0x1127*-0x1,W),L=chartConfigs[a][a3(0x225)];L['data'][a3(0x1f1)]=R,L[a3(0x1fe)][a3(0x2bc)]&&L[a3(0x1fe)][a3(0x2bc)][a3(0x298)]>0x2*0xd9a+0x2103+-0xc0b*0x5&&(L['data']['datasets'][0xad4+0x1*0x2285+-0x2d59][a3(0x1fe)]=i,chartConfigs[a][a3(0x27b)][a3(0x237)]&&(L[a3(0x1fe)][a3(0x2bc)][0x12f3+-0x5f7+0x454*-0x3][a3(0x208)]=chartConfigs[a]['params'][a3(0x237)][a3(0x2a2)](0xd*0xe5+0x1053+0x1bf4*-0x1,W),L[a3(0x1fe)][a3(0x2bc)][-0x1*0x7bf+0x178d*-0x1+0x1f4c][a3(0x2a8)]=chartConfigs[a][a3(0x27b)]['aggregatedColors']['slice'](0x3f3+-0xe4e+0xa5b,W))),L[a3(0x252)]();}  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
