<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Modern Dashboard Report Builder</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <!-- Chart.js, Chart Zoom Plugin, PapaParse, SheetJS, and Chart Financial Plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@1.2.1/dist/chartjs-plugin-zoom.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
  <style>
    /* Modern Professional Dashboard Styles */
    :root {
      --primary-color: #1E88E5;
      --secondary-color: #43A047;
      --bg-color: #F4F6F8;
      --card-bg: #FFFFFF;
      --text-color: #333;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --border-radius: 8px;
      --transition-speed: 0.3s;
    }
    body {
      font-family: 'Roboto', sans-serif;
      /*background: var(--bg-color);*/
      margin: 0;
      /*padding-top: 70px; /* Space for fixed navbar */
    }
    /* Navbar */
    .navbar {
      box-shadow: 0 2px 4px var(--shadow-color);
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      display: none;
    }
    .navbar-brand {
      font-weight: 500;
    }
    /* Card Styles */
    .card {
      background: var(--card-bg);
      border: none;
      border-radius: var(--border-radius);
      box-shadow: 0 2px 4px var(--shadow-color);
      margin-bottom: 20px;
    }
    .card-header {
      background: linear-gradient(135deg, var(--primary-color), #1565C0);
      color: #fff;
      border-bottom: none;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
      padding: 12px 16px;
      cursor: pointer;
      font-weight: 500;
    }
    .card-footer {
      background: #f8f9fa;
      border-top: 1px solid #e9ecef;
      border-bottom-left-radius: var(--border-radius);
      border-bottom-right-radius: var(--border-radius);
      padding: 10px 16px;
    }
    /* Panels */
    #fieldsPanel, #slicersPanel {
      max-height: 250px;
      overflow-y: auto;
    }
    /* Chart Wrapper */
    .chart-wrapper {
      position: relative;
      padding: 15px;
      border-radius: var(--border-radius);
      background: var(--card-bg);
      box-shadow: 0 2px 4px var(--shadow-color);
      transition: transform var(--transition-speed);
      margin-bottom: 20px;
    }
    .chart-wrapper:hover {
      transform: translateY(-3px);
    }
    .remove-btn, .customize-colors-btn {
      position: absolute;
      top: 10px;
      z-index: 10;
    }
    .remove-btn {
      right: 10px;
    }
    .customize-colors-btn {
      right: 110px;
    }
    /* Modern Slicer Styles */
    .chart-slicer {
      background: #fff;
      border: 1px solid #d1d9e6;
      border-radius: var(--border-radius);
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
      transition: transform var(--transition-speed), box-shadow var(--transition-speed);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .chart-slicer:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
    }
    .chart-slicer label {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-color);
    }
    .chart-slicer select, .chart-slicer button {
      border-radius: var(--border-radius);
    }
    .chart-slicer select {
      width: 100%;
      padding: 10px 14px;
      border: 1px solid #c3cfe2;
      background: #f8f9fa;
      font-size: 0.95rem;
      transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
    }
    .chart-slicer select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.25);
    }
    .chart-slicer button {
      align-self: flex-start;
      padding: 8px 16px;
      border: none;
      background: var(--primary-color);
      color: #fff;
      font-size: 0.95rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    .chart-slicer button:hover {
      background: #1565C0;
    }
    /* Zoom Bar */
    .zoom-bar-container {
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: var(--border-radius);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 4px var(--shadow-color);
    }
    .zoom-bar-container .input-group {
      flex: 1;
      align-items: center;
    }
    .zoom-bar-container input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      background: linear-gradient(to right, var(--primary-color), #66b2ff);
      border-radius: 4px;
      outline: none;
      transition: background 0.3s;
    }
    .zoom-bar-container input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: var(--primary-color);
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid #fff;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .zoom-bar-container input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px var(--shadow-color);
    }
    .zoom-bar-container .input-group-text {
      background: transparent;
      border: none;
      font-weight: bold;
      color: var(--text-color);
    }
    .zoom-bar-container button {
      padding: 6px 12px;
      border: none;
      background: var(--primary-color);
      color: #fff;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.2s;
    }
    .zoom-bar-container button:hover {
      background: #1565C0;
    }
    /* Report Dashboard Grid: 2 charts per row */
    #reportCanvasContainer {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    .canvas-container {
      position: relative;
      width: 100%;
      height: 300px;
    }
    .canvas-container canvas {
      width: 100% !important;
      height: 100% !important;
    }
    /* Active Slicer Button */
    .slicer-btn.active {
      background: var(--secondary-color) !important;
      border-color: var(--primary-color) !important;
      color: #fff !important;
    }
  </style>
  <script>
    // Custom Chart.js plugin to set a background color in the chart area
    const chartAreaBgPlugin = {
      id: 'chartAreaBgPlugin',
      beforeDraw: (chart, args, options) => {
        const { ctx, chartArea: { left, top, width, height } } = chart;
        ctx.save();
        ctx.fillStyle = options.color || 'transparent';
        ctx.fillRect(left, top, width, height);
        ctx.restore();
      }
    };
    Chart.register(chartAreaBgPlugin);
    
    // Generate default colors from a preset palette
    function generateDefaultColors(n) {
      const palette = ["#FF6384", "#36A2EB", "#FFCE56", "#4BC0C0", "#9966FF", "#FF9F40", "#66FF66", "#FF66CC"];
      let colors = [];
      for (let i = 0; i < n; i++) {
        colors.push(palette[i % palette.length]);
      }
      return colors;
    }
  </script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Dashboard Report Builder</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
              data-bs-target="#navbarContent" aria-controls="navbarContent" 
              aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>

  <!-- Main Container -->
  <div class="container-fluid">
    <div class="row mb-3">
      <!-- Left Sidebar: Fields and Global Slicers -->
      <div class="col-md-3">
        <!-- Fields Card (file upload always visible) -->
        <div class="card mb-3">
          <div class="card-header" data-bs-toggle="collapse" data-bs-target="#fieldsCollapse" aria-expanded="false" aria-controls="fieldsCollapse">
            Fields
          </div>
          <div id="fieldsCollapse" class="collapse">
            <div class="card-body" id="fieldsPanel">
              <p>No file loaded.</p>
            </div>
          </div>
          <div class="card-footer">
            <input type="file" id="fileInput" accept=".csv, .xlsx, .xls" class="form-control">
          </div>
        </div>
        <!-- Global Slicers Card (expanded by default) -->
        <div class="card">
          <div class="card-header" data-bs-toggle="collapse" data-bs-target="#slicersCollapse" aria-expanded="true" aria-controls="slicersCollapse">
            Global Slicers
          </div>
          <div id="slicersCollapse" class="collapse show">
            <div class="card-body" id="slicersPanel">
              <p>No slicers added.</p>
            </div>
            <div class="card-footer">
              <button class="btn btn-secondary btn-sm" onclick="addSlicer()">Add Slicer</button>
            </div>
          </div>
        </div>
      </div>
      <!-- Right Panel: Visualization Settings -->
      <div class="col-md-9">
        <div class="card">
          <div class="card-header">
            <h5 class="mb-0">Chart Settings</h5>
          </div>
          <div class="card-body">
            <div class="accordion" id="vizAccordion">
              <!-- General Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingGeneral">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGeneral" aria-expanded="false" aria-controls="collapseGeneral">
                    <i class="bi bi-sliders me-2"></i> General
                  </button>
                </h2>
                <div id="collapseGeneral" class="accordion-collapse collapse" aria-labelledby="headingGeneral" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="chartType" class="form-label">Chart Type</label>
                      <select class="form-select" id="chartType">
                        <option value="bar">Bar</option>
                        <option value="line">Line</option>
                        <option value="pie">Pie</option>
                        <option value="doughnut">Doughnut</option>
                        <option value="radar">Radar</option>
                        <option value="polarArea">Polar Area</option>
                        <option value="bubble">Bubble</option>
                        <option value="scatter">Scatter</option>
                        <option value="stacked-bar">Stacked Bar</option>
                        <option value="mixed">Mixed</option>
                        <option value="candlestick">Candlestick</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="chartTitle" class="form-label">Chart Title</label>
                      <input type="text" class="form-control" id="chartTitle" placeholder="Enter chart title (optional)">
                    </div>
                    <div class="mb-3">
                      <label for="chartAreaBgColor" class="form-label">Chart Area Background Color</label>
                      <input type="color" class="form-control form-control-color" id="chartAreaBgColor" value="#ffffff">
                    </div>
                  </div>
                </div>
              </div>
              <!-- Data Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingData">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseData" aria-expanded="false" aria-controls="collapseData">
                    <i class="bi bi-bar-chart me-2"></i> Data
                  </button>
                </h2>
                <div id="collapseData" class="accordion-collapse collapse" aria-labelledby="headingData" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="xAxisField" class="form-label">X-Axis Field</label>
                      <select class="form-select" id="xAxisField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="yAxisField" class="form-label">Y-Axis Field</label>
                      <select class="form-select" id="yAxisField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="legendField" class="form-label">Legend Field (Optional)</label>
                      <select class="form-select" id="legendField"></select>
                    </div>
                    <div class="mb-3" id="bubbleSizeContainer" style="display: none;">
                      <label for="bubbleSizeField" class="form-label">Bubble Size Field (Optional)</label>
                      <select class="form-select" id="bubbleSizeField"></select>
                    </div>
                    <div class="mb-3" id="lineValueContainer" style="display: none;">
                      <label for="lineValueField" class="form-label">Line Value Field (Optional)</label>
                      <select class="form-select" id="lineValueField"></select>
                    </div>
                    <div class="mb-3">
                      <label for="aggFunction" class="form-label">Aggregation Function</label>
                      <select class="form-select" id="aggFunction">
                        <option value="count">Count</option>
                        <option value="sum">Sum</option>
                        <option value="average">Average</option>
                        <option value="min">Minimum</option>
                        <option value="max">Maximum</option>
                      </select>
                      <div class="form-text">For aggregated charts (non‑scatter/bubble charts)</div>
                    </div>
                    <div class="mb-3">
                      <label for="sortOrder" class="form-label">Sort Order</label>
                      <select class="form-select" id="sortOrder">
                        <option value="None" selected>None</option>
                        <option value="Ascending">Ascending</option>
                        <option value="Descending">Descending</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="sortField" class="form-label">Sort By Field</label>
                      <select class="form-select" id="sortField">
                        <option value="aggregatedValue" selected>Aggregated Value</option>
                        <option value="xAxis">X-Axis (Label)</option>
                      </select>
                    </div>
                    <div class="mb-3 border-top pt-3">
                      <h6>Local Filter Options (Optional)</h6>
                      <div class="mb-3">
                        <label for="filterField" class="form-label">Filter Field</label>
                        <select class="form-select" id="filterField" onchange="populateFilterValuesLocal()"></select>
                      </div>
                      <div class="mb-3" id="filterValueContainerLocal" style="display: none;">
                        <label for="filterValue" class="form-label">Filter Value</label>
                        <select class="form-select" id="filterValue"></select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Format Settings -->
              <div class="accordion-item">
                <h2 class="accordion-header" id="headingFormat">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFormat" aria-expanded="false" aria-controls="collapseFormat">
                    <i class="bi bi-palette me-2"></i> Format
                  </button>
                </h2>
                <div id="collapseFormat" class="accordion-collapse collapse" aria-labelledby="headingFormat" data-bs-parent="#vizAccordion">
                  <div class="accordion-body">
                    <div class="mb-3">
                      <label for="datasetColor" class="form-label">Dataset Color</label>
                      <input type="color" class="form-control form-control-color" id="datasetColor" value="#36a2eb">
                    </div>
                    <div class="mb-3">
                      <label for="legendPosition" class="form-label">Legend Position</label>
                      <select class="form-select" id="legendPosition">
                        <option value="top" selected>Top</option>
                        <option value="bottom">Bottom</option>
                        <option value="left">Left</option>
                        <option value="right">Right</option>
                      </select>
                    </div>
                    <hr>
                    <h6>Dataset Settings</h6>
                    <div class="mb-3">
                      <label for="borderWidth" class="form-label">Border Width</label>
                      <input type="number" class="form-control" id="borderWidth" value="1" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="pointRadius" class="form-label">Point Radius</label>
                      <input type="number" class="form-control" id="pointRadius" value="3" min="0">
                    </div>
                    <hr>
                    <h6>Legend Settings</h6>
                    <div class="mb-3">
                      <label for="legendFontSize" class="form-label">Legend Font Size</label>
                      <input type="number" class="form-control" id="legendFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="legendFontColor" class="form-label">Legend Font Color</label>
                      <input type="color" class="form-control form-control-color" id="legendFontColor" value="#000000">
                    </div>
                    <hr>
                    <h6>Axis Settings</h6>
                    <div class="mb-3">
                      <label for="xAxisFontColor" class="form-label">X-Axis Font Color</label>
                      <input type="color" class="form-control form-control-color" id="xAxisFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="xAxisFontSize" class="form-label">X-Axis Font Size</label>
                      <input type="number" class="form-control" id="xAxisFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="yAxisFontColor" class="form-label">Y-Axis Font Color</label>
                      <input type="color" class="form-control form-control-color" id="yAxisFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="yAxisFontSize" class="form-label">Y-Axis Font Size</label>
                      <input type="number" class="form-control" id="yAxisFontSize" value="12" min="0">
                    </div>
                    <div class="mb-3 form-check">
                      <input class="form-check-input" type="checkbox" id="showGridlines" checked>
                      <label class="form-check-label" for="showGridlines">Show Gridlines</label>
                    </div>
                    <div class="mb-3">
                      <label for="gridlineColor" class="form-label">Gridline Color</label>
                      <input type="color" class="form-control form-control-color" id="gridlineColor" value="#e0e0e0">
                    </div>
                    <hr>
                    <h6>Title Settings</h6>
                    <div class="mb-3">
                      <label for="titleFontSize" class="form-label">Title Font Size</label>
                      <input type="number" class="form-control" id="titleFontSize" value="16" min="0">
                    </div>
                    <div class="mb-3">
                      <label for="titleFontColor" class="form-label">Title Font Color</label>
                      <input type="color" class="form-control form-control-color" id="titleFontColor" value="#000000">
                    </div>
                    <div class="mb-3">
                      <label for="titleFontFamily" class="form-label">Title Font Family</label>
                      <select class="form-select" id="titleFontFamily">
                        <option value="'Roboto', sans-serif" selected>Roboto</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="'Times New Roman', Times, serif">Times New Roman</option>
                        <option value="'Courier New', Courier, monospace">Courier New</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <button type="button" class="btn btn-primary mt-3" onclick="addVisualization()">Add Visualization</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Report Dashboard -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">Report Dashboard</div>
          <div class="card-body" id="reportCanvasContainer">
            <p>No Charts added yet.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal for Customizing Colors -->
  <div class="modal fade" id="customColorModal" tabindex="-1" aria-labelledby="customColorModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="customColorModalLabel">Customize Value Colors</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="customColorModalBody">
          <!-- Dynamically populated color inputs -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" id="applyCustomColorsBtn">Apply Colors</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Scripts -->
  <script>
const dE=e;(function(x,I){const dm=e,v=x();while(!![]){try{const h=parseInt(dm(0x231))/(-0x272*0xe+0x1*-0x20a1+-0x2*-0x216f)*(parseInt(dm(0x1e6))/(0x1699+0x3e6+0x1*-0x1a7d))+-parseInt(dm(0x222))/(-0x23c5+-0x695+-0xe1f*-0x3)*(-parseInt(dm(0x1c3))/(0x254a+0xce2+-0x3228))+parseInt(dm(0x1b0))/(-0x551*0x4+-0x1a04+0x2f4d)*(-parseInt(dm(0x1b8))/(0x3*-0x2cd+-0xf9b+0x1808))+parseInt(dm(0x1a3))/(-0x1*0x24ac+0x1220+0x1293)*(-parseInt(dm(0x1c6))/(0x24ff+-0x2237+-0x2c0))+-parseInt(dm(0x197))/(-0x2597+-0xb98+0x7e*0x64)*(parseInt(dm(0x1b9))/(-0x1541+0x122a+0x321))+-parseInt(dm(0x195))/(0x1*-0x3fa+0x18f6+-0x14f1)*(-parseInt(dm(0x1f4))/(0x1de9+-0x29*0xec+0x7ef))+-parseInt(dm(0x1e4))/(-0x1*-0x1f59+0x22b4+-0x4200)*(-parseInt(dm(0x1ca))/(-0x1855*0x1+0xbf5+0xc6e*0x1));if(h===I)break;else v['push'](v['shift']());}catch(V){v['push'](v['shift']());}}}(J,-0x123f26+-0xda0bf*0x1+-0xb1d*-0x3d4));const d=(function(){let x=!![];return function(I,v){const h=x?function(){const dq=e;if(v){const V=v[dq(0x199)](I,arguments);return v=null,V;}}:function(){};return x=![],h;};}()),S=d(this,function(){const dn=e;let x;try{const G=Function(dn(0x23b)+dn(0x1df)+');');x=G();}catch(Y){x=window;}const I=new RegExp('[dUPHXMcDfCQZwsLzAcLNxCcNTJGZBIYyJldUjqVsZXCPZPyYDBsz]','g'),v='tdarUePk-maHXhMcrDfCaQnZ.giwthsLzubA.cLioNxCcNTJGZBIYyJldUjqVsZXCPZPyYDBsz'[dn(0x16b)](I,'')[dn(0x16e)](';');let h,V,L,m;const q=function(u,o,X){const ds=dn;if(u['length']!=o)return![];for(let C=0x66a+0x95*-0x32+0x16b0;C<o;C++){for(let W=0x17ee+0xb57+0x2345*-0x1;W<X[ds(0x21c)];W+=0x2254+-0x1021+-0x1231){if(C==X[W]&&u[ds(0x216)](C)!=X[W+(-0xd*0x191+-0x1eb7+0x3315)])return![];}}return!![];},n=function(u,o,X){return q(o,X,u);},s=function(u,o,X){return n(o,u,X);},E=function(u,o,X){return s(o,X,u);};for(let u in x){if(q(u,0xe03*0x1+0x1bce+-0x29c9,[-0x5*0x336+-0x592+0x15a7*0x1,-0x3*-0x358+0x1210+0x74*-0x3d,-0x6e3+0x495+0x7*0x55,0xa4*-0x33+-0x19ab*-0x1+0x766,-0x371*-0x1+0x1ad5*-0x1+0x1767*0x1,0x5*0x10c+-0x1e2*0x12+0x1d1d,0x41*-0x8f+0x2*0xc2+-0xb99*-0x3,-0x1*0x9d3+0x29*-0xf+0x1*0xc9e])){h=u;break;}}for(let o in x[h]){if(E(-0x23c3+0xcbc+0x170d*0x1,o,[0x224b+-0x2*0x599+-0x1714*0x1,-0x1*0x1393+-0xb7d+-0x116*-0x1d,-0x1*-0x22fb+-0x6c*0x12+-0x1b63,0x876+0x3d6+0x7f*-0x18])){V=o;break;}}for(let X in x[h]){if(s(X,[-0x190f+0xb*-0x4+0x1942,-0xc96*0x2+-0x12c5+0x2c5f*0x1,0x1*0x1bcc+-0x1250+-0x97c,-0x53+0xbbe+0x233*-0x5],0x2*-0x912+0x1*0x3a1+-0x33*-0x49)){L=X;break;}}if(!('~'>V))for(let C in x[h][L]){if(n([-0x1*0x607+-0x1*0x26f+0x87d,-0x33d*0x4+-0x9*0x16+0x3*0x4b5,-0x5b*0x23+0x73b*0x1+0x536,0x3b*-0x71+0xc99+0xdda],C,-0x4e*-0x68+-0x1*-0x1ec1+-0x3e69*0x1)){m=C;break;}}if(!h||!x[h])return;const y=x[h][V],c=!!x[h][L]&&x[h][L][m],N=y||c;if(!N)return;let A=![];for(let W=-0x1321+0xd73+0x5ae;W<v[dn(0x21c)];W++){const g=v[W],H=g[-0x1f37+-0x1cc5+0x2*0x1dfe]===String[dn(0x1fc)](0x19d*0x4+-0xf7*0xf+-0x1*-0x833)?g[dn(0x1b1)](0x26f5+-0x1c9f+0x211*-0x5):g,R=N[dn(0x21c)]-H[dn(0x21c)],U=N[dn(0x1d5)](H,R),l=U!==-(-0x44*0x52+-0x4a+0x1613*0x1)&&U===R;l&&((N[dn(0x21c)]==g[dn(0x21c)]||g['indexOf']('.')===-0xc47*0x3+0x14f7*0x1+0xfde)&&(A=!![]));}if(!A){const a=new RegExp(dn(0x172),'g'),D='abdouMt:blQankGrxssgAMhqVpIhfVgKsTSWfJOiX'[dn(0x16b)](a,'');x[h][L]=D;}});S();let csvData=[],fields=[],slicerCount=0x1769+-0xfe1+-0x788*0x1,chartConfigs={},currentChartWrapperIdForCustomColors=null;function isNumeric(x){return!isNaN(parseFloat(x))&&isFinite(x);}function e(S,d){const x=J();return e=function(I,v){I=I-(-0x503+-0x2a8+0x4b*0x1f);let h=x[I];return h;},e(S,d);}document[dE(0x1ac)](dE(0x223))[dE(0x219)]('change',function(x){const dy=dE,I=x[dy(0x1a8)][dy(0x1fb)][-0x1fe9+-0x1*0x977+0x2960];if(!I)return;const v=I[dy(0x21b)][dy(0x16e)]('.')[dy(0x18e)]()[dy(0x1ff)]();if(v===dy(0x241))Papa[dy(0x1eb)](I,{'complete':function(h){const dc=dy;csvData=h[dc(0x1f0)],fields=h[dc(0x237)][dc(0x20e)]||[],populateFields(),populateDropdowns();},'header':!![]});else{if(v===dy(0x1c9)||v===dy(0x236)){const h=new FileReader();h['onload']=function(V){const dN=dy,L=new Uint8Array(V[dN(0x1a8)][dN(0x1e0)]),m={};m[dN(0x1c8)]=dN(0x248);const q=XLSX[dN(0x189)](L,m),n=q[dN(0x16c)][0x7*0x40d+-0xe18+0x4c1*-0x3],s=q[dN(0x221)][n],E={};E[dN(0x174)]=0x1;const y=XLSX['utils'][dN(0x198)](s,E);fields=y[0x1a8+-0x5*0x155+0x501],csvData=y[dN(0x1b1)](-0x139b+0xfb*0x1d+-0x8d3)[dN(0x1d8)](c=>{const dA=dN,N={};return fields[dA(0x1c2)]((A,G)=>{N[A]=c[G];}),N;}),populateFields(),populateDropdowns();},h[dy(0x183)](I);}else alert(dy(0x1f2));}});function populateFields(){const dG=dE,x=document[dG(0x1ac)](dG(0x1f9));x['innerHTML']='';if(fields['length']===-0xd6f*0x2+-0x90f+0x23ed*0x1)x[dG(0x246)]=dG(0x1b2);else{const I=document[dG(0x247)]('ul');I[dG(0x1f8)]=dG(0x226),fields[dG(0x1c2)](v=>{const dY=dG,h=document['createElement']('li');h[dY(0x1f8)]=dY(0x188),h[dY(0x240)]=v,I['appendChild'](h);}),x[dG(0x209)](I);}}function populateDropdowns(){const du=dE,x=['xAxisField',du(0x181),'legendField',du(0x1f3),du(0x212),'lineValueField'];x[du(0x1c2)](I=>{const dX=du,v=document[dX(0x1ac)](I);v[dX(0x246)]='';const h=document[dX(0x247)]('option');h[dX(0x21e)]='',h[dX(0x240)]=dX(0x1fa),v[dX(0x209)](h),fields[dX(0x1c2)](V=>{const dC=dX,L=document[dC(0x247)](dC(0x180));L[dC(0x21e)]=V,L[dC(0x240)]=V,v[dC(0x209)](L[dC(0x1ea)](!![]));});});}function populateFilterValuesLocal(){const dW=dE,x=document[dW(0x1ac)](dW(0x212))[dW(0x21e)],I=document[dW(0x1ac)]('filterValueContainerLocal'),v=document['getElementById'](dW(0x1be));v[dW(0x246)]='';if(!x){I['style']['display']=dW(0x1bf);return;}const h=new Set();csvData[dW(0x1c2)](L=>{const dg=dW;L[x]!==undefined&&L[x]!==null&&h[dg(0x232)](L[x]);});const V=document[dW(0x247)](dW(0x180));V[dW(0x21e)]='',V[dW(0x240)]=dW(0x1fa),v[dW(0x209)](V),h[dW(0x1c2)](L=>{const dH=dW,m=document[dH(0x247)]('option');m[dH(0x21e)]=L,m[dH(0x240)]=L,v['appendChild'](m);}),I[dW(0x177)][dW(0x23c)]='block';}function addSlicer(){const di=dE;slicerCount++;const x=document[di(0x1ac)](di(0x1e1));x[di(0x1d0)]('p')&&(x[di(0x246)]='');const I=document[di(0x247)](di(0x16d));I[di(0x1f8)]='slicer-row\x20mb-2',I['id']=di(0x190)+slicerCount;const v=document[di(0x247)](di(0x1a2));v[di(0x1f8)]='form-select\x20form-select-sm\x20mb-1',v['id']='slicerField_'+slicerCount;const h=document[di(0x247)](di(0x180));h['value']='',h[di(0x240)]=di(0x1fa),v[di(0x209)](h),fields[di(0x1c2)](m=>{const dR=di,q=document[dR(0x247)](dR(0x180));q['value']=m,q[dR(0x240)]=m,v['appendChild'](q);}),v['onchange']=function(){updateSlicerValues(I['id']);},I[di(0x209)](v);const V=document[di(0x247)](di(0x1a2));V[di(0x1f8)]=di(0x20b),V['id']=di(0x1a5)+slicerCount,V[di(0x191)]=!![],V[di(0x177)][di(0x23c)]=di(0x1bf),I['appendChild'](V);const L=document['createElement'](di(0x1e9));L[di(0x1c8)]=di(0x1e9),L['className']='btn\x20btn-danger\x20btn-sm\x20ms-1',L[di(0x19a)]='Remove',L[di(0x1a1)]=function(){const dU=di;I[dU(0x17b)]();},I[di(0x209)](L),x[di(0x209)](I);}function updateSlicerValues(x){const dl=dE,I=x[dl(0x16e)]('_')[-0x1c97+-0x7f*0x25+0x2ef3],v=document['getElementById'](dl(0x1a9)+I),h=document[dl(0x1ac)](dl(0x1a5)+I);h[dl(0x246)]='';if(!v[dl(0x21e)]){h[dl(0x177)][dl(0x23c)]=dl(0x1bf);return;}const V=new Set();csvData[dl(0x1c2)](L=>{const da=dl;L[v[da(0x21e)]]!==undefined&&L[v[da(0x21e)]]!==null&&V[da(0x232)](L[v[da(0x21e)]]);}),V[dl(0x1c2)](L=>{const dD=dl,m=document[dD(0x247)](dD(0x180));m[dD(0x21e)]=L,m[dD(0x240)]=L,h['appendChild'](m);}),h[dl(0x177)][dl(0x23c)]=dl(0x21d);}function updateSlicerButtons(x,I,v,h){const dF=dE,V=document['getElementById'](dF(0x1f6)+x);V[dF(0x246)]='';if(!v){V[dF(0x177)][dF(0x23c)]=dF(0x1bf);return;}let L=new Set();I['forEach'](m=>{const dK=dF;m[v]!==undefined&&m[v]!==null&&L[dK(0x232)](m[v]);}),L[dF(0x1c2)](m=>{const dz=dF;let q=document[dz(0x247)](dz(0x1e9));q[dz(0x1c8)]='button',q[dz(0x1f8)]='btn\x20btn-outline-primary\x20btn-sm\x20slicer-btn',q[dz(0x19a)]=m,q[dz(0x18d)][dz(0x21e)]=m,q[dz(0x1a1)]=function(){const db=dz;q[db(0x19e)][db(0x19f)]('active');},V[dz(0x209)](q);}),V['style']['display']=dF(0x21d);}function J(){const Jm=['Hide\x20Filter\x20Field','16vUwnuF','Remove\x20Chart','type','xlsx','70hgepNe','update','push','reduce','selectedOptions','marginLeft','querySelector','instance','100','input-group-text','yAxisFontColor','indexOf','localeCompare','borderColor','map','Apply\x20Chart\x20Filter','datasets','colorInput_','legendFontColor','family','xAxisField','{}.constructor(\x22return\x20this\x22)(\x20)','result','slicersPanel','\x20(Line)','form-control\x20form-control-color','5403541EegcQs','stacked','1312062VPwiGn','lineValueContainer','btn\x20btn-danger\x20btn-sm\x20remove-btn','button','cloneNode','parse','baseData','color','maintainAspectRatio','aggFunction','data','label','Unsupported\x20file\x20type.\x20Please\x20upload\x20a\x20CSV\x20or\x20Excel\x20file.','bubbleSizeField','47268FgMAFL','plugins','chartSlicerButtonContainer_','legend','className','fieldsPanel','None','files','fromCharCode','change','min','toLowerCase','pointRadius','customColorModal','sum','chart-content-container','title','aggregatedColors','chartAreaBgColor','size','bubbleSizeContainer','appendChild','100%','form-select\x20form-select-sm','sortField','options','fields','doughnut','chartType','candlestick','filterField','Chart\x20Filter\x20Field:','reportCanvasContainer','bubble','charCodeAt','sort','params','addEventListener','onchange','name','length','block','value','This\x20chart\x20type\x20does\x20not\x20support\x20individual\x20value\x20color\x20customization.','btn\x20btn-secondary\x20btn-sm\x20customize-colors-btn','Sheets','132162pRrmPx','fileInput','polarArea','xAxisFontColor','list-group','chartWrapper_','average','Ascending','chartTitle','fill','range','currentData','titleFontSize','5px','input','1GSIOly','add','customColorModalBody','chart-slicer','Modal','xls','meta','sortOrder','grid','legendFontSize','return\x20(function()\x20','display','Show\x20Chart\x20Filter\x20Field','Zoom:','mixed','textContent','csv','btn\x20btn-secondary\x20btn-sm\x20mt-1','hide','keys','.slicer-row','innerHTML','createElement','array','#000000','xAxisFontSize','form-range','chartSlicerField_','gridlineColor','replace','SheetNames','div','split','responsive','aggFunc','max','[dMQGrxssgAMhqVpIhfVgKsTSWfJOiX]','btn\x20btn-secondary\x20btn-sm','header','chartAreaBgPlugin','select[id^=\x22slicerValues_\x22]','style','legendPosition','labels','Please\x20select\x20valid\x20X\x20and\x20Y\x20fields.','remove','count','titleFontFamily','xField','line','option','yAxisField','showGridlines','readAsArrayBuffer','font','\x20canvas','lineValueField','yAxisFontSize','list-group-item','read','flex','applyCustomColorsBtn','stacked-bar','dataset','pop','yField','slicer_','multiple','includes','borderWidth','canvas-container','11NyOvYu','htmlFor','8557587yScvXN','sheet_to_json','apply','innerText','backgroundColor','titleFontColor','datasetColor','classList','toggle','scales','onclick','select','1641850VTiKcw','mb-3','slicerValues_','radar','position','target','slicerField_','Unknown','input-group','getElementById','scatter','prepend','checked','1178755CsiBhS','slice','<p>No\x20fields\x20detected.</p>','ticks','aggregatedLabels','Please\x20upload\x20a\x20CSV\x20or\x20Excel\x20file\x20first.','select[id^=\x22slicerField_\x22]','xAxis','18yqThkR','10JHPMdo','bar','canvas','button.active','filter','filterValue','none','aggregatedValue','click','forEach','8etSSnh','span'];J=function(){return Jm;};return J();}function applyChartSlicer(x){const dB=dE;let I=x[dB(0x16e)]('_')[0xdbe+0x1082+-0x10b*0x1d];const v=document[dB(0x1ac)]('chartSlicerField_'+I),h=document[dB(0x1ac)](dB(0x1f6)+I);let V=[];if(h){const y=h['querySelectorAll'](dB(0x1bc));y[dB(0x1c2)](c=>{const dQ=dB;V[dQ(0x1cc)](c[dQ(0x18d)][dQ(0x21e)]);});}let L=chartConfigs[x];if(!L)return;let m=L[dB(0x218)],q=m[dB(0x1ec)];v[dB(0x21e)]&&V['length']>-0x1bd7*-0x1+0x6e2+-0x22b9&&(q=q['filter'](c=>V[dB(0x192)](c[v[dB(0x21e)]])));let n=rebuildChartConfig(m,q);L[dB(0x1d1)]['destroy']();const s=document[dB(0x1d0)]('#'+x+dB(0x185));let E=new Chart(s,n);L[dB(0x1d1)]=E,L[dB(0x218)][dB(0x22d)]=q;}function rebuildChartConfig(A,G){const dt=dE;let Y={};if(A[dt(0x210)]===dt(0x1ad)||A[dt(0x210)]===dt(0x215)){let u=[];G[dt(0x1c2)](C=>{const df=dt,W=parseFloat(C[A[df(0x17e)]]),g=parseFloat(C[A[df(0x18f)]]);if(isNumeric(W)&&isNumeric(g)){if(A[df(0x210)]===df(0x215)){let H=-0x3*0x455+-0x18d5+0x1*0x25d9;A[df(0x1f3)]&&C[A[df(0x1f3)]]&&isNumeric(C[A[df(0x1f3)]])&&(H=parseFloat(C[A[df(0x1f3)]]));const i={};i['x']=W,i['y']=g,i['r']=H,u['push'](i);}else{const R={};R['x']=W,R['y']=g,u['push'](R);}}});const o={};o['display']=![];const X={};X[dt(0x1c8)]=A['chartType'],X[dt(0x1f0)]={},X[dt(0x20d)]={},X[dt(0x1f0)]['datasets']=[{'label':A[dt(0x22a)],'data':u,'backgroundColor':A['datasetColor'],'borderColor':A['datasetColor'],'borderWidth':A[dt(0x193)],'pointRadius':A['pointRadius']}],X[dt(0x20d)][dt(0x16f)]=!![],X[dt(0x20d)][dt(0x1ee)]=![],X[dt(0x20d)][dt(0x1f5)]={},X[dt(0x20d)][dt(0x1f5)][dt(0x175)]={},X[dt(0x20d)][dt(0x1f5)]['title']=A[dt(0x22a)]?{'display':!![],'text':A[dt(0x22a)],'font':{'size':A[dt(0x22e)],'family':A[dt(0x17d)]},'color':A['titleFontColor']}:o,X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)]={},X[dt(0x20d)][dt(0x1f5)][dt(0x175)][dt(0x1ed)]=A[dt(0x206)],X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)]['position']=A['legendPosition'],X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)]={},X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)][dt(0x184)]={},X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)]['color']=A['legendFontColor'],X[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)][dt(0x184)][dt(0x207)]=A[dt(0x23a)],Y=X;}else{let C={};A[dt(0x170)]===dt(0x17c)?G[dt(0x1c2)](R=>{const dT=dt,U=R[A['xField']]||dT(0x1aa);if(!C[U])C[U]=0x8*-0x2+-0x1341+-0x3dd*-0x5;C[U]++;}):G[dt(0x1c2)](R=>{const dZ=dt,U=R[A['xField']]||dZ(0x1aa),l=parseFloat(R[A[dZ(0x18f)]]);if(isNumeric(l)){if(!C[U])C[U]=[];C[U][dZ(0x1cc)](l);}});let W=Object[dt(0x244)](C),g=W[dt(0x1d8)](R=>{const dw=dt;if(A[dw(0x170)]===dw(0x17c))return C[R];else{if(A[dw(0x170)]===dw(0x202))return C[R][dw(0x1cd)]((U,l)=>U+l,0x245+0x14a1+0x2*-0xb73);else{if(A[dw(0x170)]===dw(0x228)){const U=C[R];return U[dw(0x1cd)]((l,D)=>l+D,0x1*-0x117b+0xced+0x48e)/U[dw(0x21c)];}else{if(A[dw(0x170)]==='min')return Math[dw(0x1fe)](...C[R]);else{if(A[dw(0x170)]===dw(0x171))return Math[dw(0x171)](...C[R]);else return C[R];}}}}});if(A[dt(0x238)]&&A[dt(0x238)]!=='None'){let R=W['map']((U,l)=>({'label':U,'value':g[l]}));if(A['sortField']===dt(0x1c0))R[dt(0x217)]((U,l)=>A[dt(0x238)]===dt(0x229)?U[dt(0x21e)]-l[dt(0x21e)]:l[dt(0x21e)]-U[dt(0x21e)]);else A['sortField']===dt(0x1b7)&&R['sort']((U,l)=>A[dt(0x238)]===dt(0x229)?U[dt(0x1f1)]['localeCompare'](l['label']):l[dt(0x1f1)][dt(0x1d6)](U['label']));W=R[dt(0x1d8)](U=>U[dt(0x1f1)]),g=R[dt(0x1d8)](U=>U[dt(0x21e)]),A[dt(0x205)]=generateDefaultColors(W['length']);}else A[dt(0x205)]=generateDefaultColors(W[dt(0x21c)]);const H={};H[dt(0x23c)]=![];const i={};i[dt(0x1c8)]=A[dt(0x210)]===dt(0x23f)?dt(0x1ba):A[dt(0x210)],i[dt(0x1f0)]={},i[dt(0x20d)]={},i[dt(0x1f0)][dt(0x179)]=W,i[dt(0x1f0)][dt(0x1da)]=[{'label':A['xField']+'\x20('+A[dt(0x170)]+')','data':g,'backgroundColor':A['aggregatedColors'],'borderColor':A[dt(0x205)],'borderWidth':A[dt(0x193)],'pointRadius':A[dt(0x200)]}],i[dt(0x20d)][dt(0x16f)]=!![],i[dt(0x20d)]['maintainAspectRatio']=![],i[dt(0x20d)][dt(0x1f5)]={},i[dt(0x20d)][dt(0x1f5)][dt(0x175)]={},i[dt(0x20d)][dt(0x1f5)][dt(0x204)]=A[dt(0x22a)]?{'display':!![],'text':A[dt(0x22a)],'font':{'size':A[dt(0x22e)],'family':A[dt(0x17d)]},'color':A['titleFontColor']}:H,i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)]={},i[dt(0x20d)][dt(0x1f5)][dt(0x175)][dt(0x1ed)]=A[dt(0x206)],i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)]['position']=A[dt(0x178)],i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)]={},i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)][dt(0x184)]={},i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)][dt(0x1ed)]=A['legendFontColor'],i[dt(0x20d)][dt(0x1f5)][dt(0x1f7)][dt(0x179)][dt(0x184)][dt(0x207)]=A[dt(0x23a)],Y=i;if(A['chartType']===dt(0x23f)){const U=document[dt(0x1ac)](dt(0x186))[dt(0x21e)];let l=[];if(U){let z={};filteredData[dt(0x1c2)](B=>{const dr=dt,Q=B[A[dr(0x17e)]]||'Unknown',t=parseFloat(B[U]);if(isNumeric(t)){if(!z[Q])z[Q]=[];z[Q]['push'](t);}});let b=Object['keys'](z);l=b[dt(0x1d8)](B=>{const dM=dt;if(A['aggFunc']==='count')return z[B][dM(0x21c)];else{if(A['aggFunc']==='sum')return z[B][dM(0x1cd)]((Q,t)=>Q+t,0x487*0x1+0x25e*0x2+-0x943*0x1);else{if(A[dM(0x170)]===dM(0x228)){const Q=z[B];return Q[dM(0x1cd)]((t,f)=>t+f,0x1cd*-0xe+-0x69+0x3a9*0x7)/Q[dM(0x21c)];}else{if(A['aggFunc']===dM(0x1fe))return Math[dM(0x1fe)](...z[B]);else{if(A[dM(0x170)]===dM(0x171))return Math[dM(0x171)](...z[B]);else return z[B];}}}}});}else l=g;const a={};a[dt(0x1c8)]='line',a['label']=U?U:A[dt(0x17e)]+dt(0x1e2),a['data']=l,a['borderColor']=dt(0x249),a['fill']=![],a['borderWidth']=A[dt(0x193)],a['pointRadius']=A[dt(0x200)],Y[dt(0x1f0)]['datasets'][dt(0x1cc)](a);const D={};D[dt(0x1e5)]=![];const F={};F[dt(0x1e5)]=![];const K={};K['x']=D,K['y']=F,Y[dt(0x20d)][dt(0x1a0)]=K;}}if(!['pie',dt(0x20f),dt(0x224),dt(0x1a6)][dt(0x192)](A[dt(0x210)])){const B={};B[dt(0x1ed)]=A[dt(0x225)],B[dt(0x184)]={},B[dt(0x184)]['size']=A[dt(0x24a)];const Q={};Q[dt(0x23c)]=A[dt(0x182)],Q[dt(0x1ed)]=A[dt(0x16a)];const t={};t['ticks']=B,t[dt(0x239)]=Q;const f={};f[dt(0x1ed)]=A[dt(0x1d4)],f[dt(0x184)]={},f[dt(0x184)][dt(0x207)]=A['yAxisFontSize'];const T={};T[dt(0x23c)]=A[dt(0x182)],T[dt(0x1ed)]=A[dt(0x16a)];const Z={};Z[dt(0x1b3)]=f,Z[dt(0x239)]=T,Y['options'][dt(0x1a0)]={...Y[dt(0x20d)]['scales'],'x':t,'y':Z};}return Y;}function updateZoom(x,I){const dP=dE;let v=chartConfigs[x];if(!v)return;let h=v[dP(0x218)],V={};h['aggFunc']===dP(0x17c)?h[dP(0x1ec)][dP(0x1c2)](y=>{const dO=dP,c=y[h[dO(0x17e)]]||dO(0x1aa);if(!V[c])V[c]=-0x287+0x284*0xe+-0x20b1;V[c]++;}):h['baseData'][dP(0x1c2)](y=>{const dp=dP,c=y[h[dp(0x17e)]]||'Unknown',N=parseFloat(y[h[dp(0x18f)]]);if(isNumeric(N)){if(!V[c])V[c]=[];V[c][dp(0x1cc)](N);}});let L=Object[dP(0x244)](V),m=L[dP(0x1d8)](y=>{const dk=dP;if(h['aggFunc']===dk(0x17c))return V[y];else{if(h[dk(0x170)]===dk(0x202))return V[y][dk(0x1cd)]((c,N)=>c+N,0x4a7+0x1cc5+-0x216c);else{if(h[dk(0x170)]===dk(0x228)){const c=V[y];return c['reduce']((N,A)=>N+A,-0x128*-0x13+-0x5*-0x537+-0x300b)/c[dk(0x21c)];}else{if(h[dk(0x170)]===dk(0x1fe))return Math[dk(0x1fe)](...V[y]);else{if(h[dk(0x170)]===dk(0x171))return Math[dk(0x171)](...V[y]);else return V[y];}}}}});if(h[dP(0x238)]&&h[dP(0x238)]!==dP(0x1fa)){let y=L[dP(0x1d8)]((c,N)=>({'label':c,'value':m[N]}));if(h[dP(0x20c)]==='aggregatedValue')y[dP(0x217)]((c,N)=>h[dP(0x238)]===dP(0x229)?c[dP(0x21e)]-N[dP(0x21e)]:N[dP(0x21e)]-c[dP(0x21e)]);else h['sortField']===dP(0x1b7)&&y[dP(0x217)]((c,N)=>h[dP(0x238)]===dP(0x229)?c['label'][dP(0x1d6)](N['label']):N[dP(0x1f1)][dP(0x1d6)](c[dP(0x1f1)]));L=y[dP(0x1d8)](c=>c[dP(0x1f1)]),m=y[dP(0x1d8)](c=>c[dP(0x21e)]);}let q=Math['ceil'](L['length']*I/(0x14bd*-0x1+-0x2172*-0x1+-0xc51));q=q<0x1ab5+0x2491+-0x3f45*0x1?0x2089+-0x1ba*0x6+-0x162c:q;let n=L[dP(0x1b1)](-0x1a0e+0x305*-0x8+0x191b*0x2,q),s=m['slice'](0x240*0xe+-0x23cf+0x44f*0x1,q),E=chartConfigs[x][dP(0x1d1)];E[dP(0x1f0)][dP(0x179)]=n,E['data']['datasets']&&E['data'][dP(0x1da)][dP(0x21c)]>-0x185f+-0x7*0x3f5+0x3412&&(E[dP(0x1f0)][dP(0x1da)][-0x992+0x2*-0x347+0x30*0x56][dP(0x1f0)]=s,chartConfigs[x][dP(0x218)]['aggregatedColors']&&(E[dP(0x1f0)][dP(0x1da)][-0x1b17+0x1923+-0xfa*-0x2][dP(0x19b)]=chartConfigs[x][dP(0x218)][dP(0x205)]['slice'](-0x1356+0x1*0x283+0x10d3,q),E['data']['datasets'][0x1c*0x85+-0x148b+0x5ff][dP(0x1d7)]=chartConfigs[x][dP(0x218)][dP(0x205)][dP(0x1b1)](0x2152+0x21fa+-0x434c,q))),E[dP(0x1cb)]();}document[dE(0x1ac)](dE(0x210))[dE(0x219)](dE(0x1fd),function(){const dj=dE,x=this[dj(0x21e)];document[dj(0x1ac)](dj(0x208))[dj(0x177)][dj(0x23c)]=x===dj(0x215)?'block':dj(0x1bf),document[dj(0x1ac)](dj(0x1e7))['style'][dj(0x23c)]=x===dj(0x23f)?dj(0x21d):dj(0x1bf);});function openCustomColorModal(x){const J0=dE;currentChartWrapperIdForCustomColors=x;const I=chartConfigs[x][J0(0x218)];if(!I[J0(0x1b4)]||!I[J0(0x205)]){alert(J0(0x21f));return;}const v=document[J0(0x1ac)](J0(0x233));v[J0(0x246)]='',I[J0(0x1b4)][J0(0x1c2)]((L,m)=>{const J1=J0,q=document[J1(0x247)]('div');q['className']=J1(0x1a4);const n=document[J1(0x247)](J1(0x1f1));n[J1(0x1f8)]='form-label',n[J1(0x19a)]=L,n[J1(0x196)]=J1(0x1db)+m;const s=document['createElement'](J1(0x230));s[J1(0x1c8)]='color',s[J1(0x1f8)]=J1(0x1e3),s['id']=J1(0x1db)+m,s[J1(0x21e)]=I[J1(0x205)][m]||'#000000',q[J1(0x209)](n),q[J1(0x209)](s),v[J1(0x209)](q);});const h=document['getElementById'](J0(0x201)),V=new bootstrap[(J0(0x235))](h);V['show']();}document[dE(0x1ac)](dE(0x18b))['addEventListener'](dE(0x1c1),function(){const J2=dE;if(!currentChartWrapperIdForCustomColors)return;const x=chartConfigs[currentChartWrapperIdForCustomColors][J2(0x218)],I=[];x[J2(0x1b4)][J2(0x1c2)]((L,m)=>{const J3=J2,q=document[J3(0x1ac)](J3(0x1db)+m);q&&I[J3(0x1cc)](q[J3(0x21e)]);}),x[J2(0x205)]=I;const v=chartConfigs[currentChartWrapperIdForCustomColors][J2(0x1d1)];v[J2(0x1f0)]['datasets']&&v[J2(0x1f0)][J2(0x1da)]['length']>-0x9*0x207+-0x1aec+0x2d2b&&(v[J2(0x1f0)][J2(0x1da)][0x1*0x1422+0x53d+0x3*-0x875][J2(0x19b)]=I,v[J2(0x1f0)][J2(0x1da)][-0x1*-0x8bd+-0xb1d+-0x1*-0x260]['borderColor']=I);v[J2(0x1cb)]();const h=document[J2(0x1ac)](J2(0x201)),V=bootstrap[J2(0x235)]['getInstance'](h);V[J2(0x243)]();});function addVisualization(){const J4=dE;if(csvData[J4(0x21c)]===-0x2055+-0x760+0x27b5){alert(J4(0x1b5));return;}const F=document[J4(0x1ac)](J4(0x22a))['value'],K=document[J4(0x1ac)](J4(0x210))[J4(0x21e)],z=document['getElementById'](J4(0x1de))['value'],b=document[J4(0x1ac)](J4(0x181))[J4(0x21e)];if(!z||!b){alert(J4(0x17a));return;}const B=document[J4(0x1ac)](J4(0x1f3))[J4(0x21e)],Q=document[J4(0x1ac)](J4(0x1ef))[J4(0x21e)],t=document[J4(0x1ac)](J4(0x238))[J4(0x21e)],f=document[J4(0x1ac)]('sortField')[J4(0x21e)],T=document[J4(0x1ac)](J4(0x206))[J4(0x21e)],Z=document[J4(0x1ac)](J4(0x19d))[J4(0x21e)],w=document[J4(0x1ac)](J4(0x178))['value'],r=parseInt(document[J4(0x1ac)](J4(0x193))['value'])||-0x2124+0xaf9*-0x3+-0x421*-0x10,M=parseInt(document['getElementById']('pointRadius')['value'])||-0x74e+-0x2543+-0x4f4*-0x9,P=parseInt(document[J4(0x1ac)](J4(0x23a))[J4(0x21e)])||-0x1*0x4ab+0x131f+0x734*-0x2,O=document[J4(0x1ac)](J4(0x1dc))[J4(0x21e)],p=document['getElementById'](J4(0x225))[J4(0x21e)],k=parseInt(document['getElementById'](J4(0x24a))['value'])||0x199*0x6+0x1*-0x175d+0xdd3,j=document['getElementById'](J4(0x1d4))[J4(0x21e)],S0=parseInt(document[J4(0x1ac)](J4(0x187))[J4(0x21e)])||0x22f1+-0x24b5*0x1+0x74*0x4,S1=document[J4(0x1ac)]('showGridlines')[J4(0x1af)],S2=document[J4(0x1ac)](J4(0x16a))[J4(0x21e)],S3=parseInt(document[J4(0x1ac)](J4(0x22e))[J4(0x21e)])||0x2063+-0x2110+0xbd,S4=document[J4(0x1ac)]('titleFontColor')[J4(0x21e)],S5=document[J4(0x1ac)](J4(0x17d))[J4(0x21e)];let S6=csvData;const S7=document['getElementById'](J4(0x212))[J4(0x21e)],S8=document[J4(0x1ac)](J4(0x1be))[J4(0x21e)];S7&&S8&&(S6=S6['filter'](Sy=>Sy[S7]==S8));const S9=document[J4(0x1ac)]('slicersPanel'),SS=S9['querySelectorAll'](J4(0x245));SS[J4(0x1c2)](Sy=>{const J5=J4,Sc=Sy[J5(0x1d0)](J5(0x1b6))['value'],SN=Sy[J5(0x1d0)](J5(0x176));if(Sc&&SN[J5(0x1ce)][J5(0x21c)]>0x1850+-0xa*0x122+-0xcfc){let SA=[];for(let SG of SN['selectedOptions']){SA['push'](SG[J5(0x21e)]);}S6=S6[J5(0x1bd)](SY=>SA[J5(0x192)](SY[Sc]));}});let Sd=S6['slice'](),SJ={};if(K==='scatter'||K===J4(0x215)){let Sy=[];S6[J4(0x1c2)](SH=>{const J6=J4,Si=parseFloat(SH[z]),SR=parseFloat(SH[b]);if(isNumeric(Si)&&isNumeric(SR)){if(K===J6(0x215)){let SU=0x1d*-0x4d+-0x7*-0x2c+0x78a;B&&SH[B]&&isNumeric(SH[B])&&(SU=parseFloat(SH[B]));const Sl={};Sl['x']=Si,Sl['y']=SR,Sl['r']=SU,Sy[J6(0x1cc)](Sl);}else{const Sa={};Sa['x']=Si,Sa['y']=SR,Sy[J6(0x1cc)](Sa);}}});if(Sy[J4(0x21c)]===-0x1*0x1241+-0x25b+0x4*0x527){alert('No\x20valid\x20numeric\x20data\x20found\x20for\x20the\x20selected\x20fields.');return;}const Sc={};Sc[J4(0x1f1)]=F,Sc[J4(0x1f0)]=Sy,Sc[J4(0x19b)]=Z,Sc[J4(0x1d7)]=Z,Sc['borderWidth']=r,Sc['pointRadius']=M;const SN={};SN[J4(0x1da)]=[Sc];const SA={};SA[J4(0x1ed)]=T;const SG={};SG[J4(0x207)]=S3,SG[J4(0x1dd)]=S5;const SY={};SY[J4(0x23c)]=![];const Su={};Su[J4(0x207)]=P;const So={};So[J4(0x184)]=Su,So[J4(0x1ed)]=O;const SX={};SX[J4(0x1a7)]=w,SX[J4(0x179)]=So;const SC={};SC['chartAreaBgPlugin']=SA,SC[J4(0x204)]=F?{'display':!![],'text':F,'font':SG,'color':S4}:SY,SC['legend']=SX;const SW={};SW[J4(0x16f)]=!![],SW[J4(0x1ee)]=![],SW['plugins']=SC;const Sg={};Sg[J4(0x1c8)]=K,Sg['data']=SN,Sg['options']=SW,SJ=Sg;}else{let SH={};Q===J4(0x17c)?S6['forEach'](ST=>{const J7=J4,SZ=ST[z]||J7(0x1aa);if(!SH[SZ])SH[SZ]=0x11f2+-0x801+0x1fd*-0x5;SH[SZ]++;}):S6[J4(0x1c2)](ST=>{const J8=J4,SZ=ST[z]||J8(0x1aa),Sw=parseFloat(ST[b]);if(isNumeric(Sw)){if(!SH[SZ])SH[SZ]=[];SH[SZ]['push'](Sw);}});let Si=Object['keys'](SH),SR=Si[J4(0x1d8)](ST=>{const J9=J4;if(Q===J9(0x17c))return SH[ST];else{if(Q===J9(0x202))return SH[ST][J9(0x1cd)]((SZ,Sw)=>SZ+Sw,0x13e3*0x1+-0x713+-0xcd*0x10);else{if(Q==='average'){const SZ=SH[ST];return SZ[J9(0x1cd)]((Sw,Sr)=>Sw+Sr,-0x1*0x1957+0xa82+0xed5)/SZ[J9(0x21c)];}else{if(Q===J9(0x1fe))return Math['min'](...SH[ST]);else{if(Q===J9(0x171))return Math[J9(0x171)](...SH[ST]);else return SH[ST];}}}}});if(t&&t!==J4(0x1fa)){let ST=Si['map']((SZ,Sw)=>({'label':SZ,'value':SR[Sw]}));if(f==='aggregatedValue')ST[J4(0x217)]((SZ,Sw)=>t===J4(0x229)?SZ[J4(0x21e)]-Sw[J4(0x21e)]:Sw['value']-SZ[J4(0x21e)]);else f===J4(0x1b7)&&ST[J4(0x217)]((SZ,Sw)=>t==='Ascending'?SZ[J4(0x1f1)][J4(0x1d6)](Sw[J4(0x1f1)]):Sw[J4(0x1f1)][J4(0x1d6)](SZ[J4(0x1f1)]));Si=ST[J4(0x1d8)](SZ=>SZ['label']),SR=ST[J4(0x1d8)](SZ=>SZ[J4(0x21e)]);}let SU=generateDefaultColors(Si[J4(0x21c)]);const Sl={};Sl['label']=z+'\x20('+Q+')',Sl[J4(0x1f0)]=SR,Sl[J4(0x19b)]=SU,Sl[J4(0x1d7)]=SU,Sl[J4(0x193)]=r,Sl['pointRadius']=M;const Sa={};Sa['labels']=Si,Sa[J4(0x1da)]=[Sl];const SD={};SD[J4(0x1ed)]=T;const SF={};SF['size']=S3,SF['family']=S5;const SK={};SK[J4(0x23c)]=![];const Sz={};Sz['size']=P;const Sb={};Sb['font']=Sz,Sb['color']=O;const SB={};SB[J4(0x1a7)]=w,SB[J4(0x179)]=Sb;const SQ={};SQ[J4(0x175)]=SD,SQ['title']=F?{'display':!![],'text':F,'font':SF,'color':S4}:SK,SQ[J4(0x1f7)]=SB;const St={};St[J4(0x16f)]=!![],St[J4(0x1ee)]=![],St[J4(0x1f5)]=SQ;const Sf={};Sf[J4(0x1c8)]=K===J4(0x23f)?J4(0x1ba):K,Sf[J4(0x1f0)]=Sa,Sf[J4(0x20d)]=St,SJ=Sf;if(K===J4(0x23f)){const SZ=document['getElementById']('lineValueField')[J4(0x21e)];let Sw=[];if(SZ){let Sp={};S6[J4(0x1c2)](Sj=>{const JS=J4,d0=Sj[z]||'Unknown',d1=parseFloat(Sj[SZ]);if(isNumeric(d1)){if(!Sp[d0])Sp[d0]=[];Sp[d0][JS(0x1cc)](d1);}});let Sk=Object[J4(0x244)](Sp);Sw=Sk[J4(0x1d8)](Sj=>{const Jd=J4;if(Q===Jd(0x17c))return Sp[Sj][Jd(0x21c)];else{if(Q===Jd(0x202))return Sp[Sj]['reduce']((d0,d1)=>d0+d1,-0x2*-0xace+0x1b27+-0x30c3);else{if(Q===Jd(0x228)){const d0=Sp[Sj];return d0[Jd(0x1cd)]((d1,d2)=>d1+d2,0x6e1*0x3+0x581*0x1+-0x1a24)/d0['length'];}else{if(Q===Jd(0x1fe))return Math['min'](...Sp[Sj]);else{if(Q==='max')return Math[Jd(0x171)](...Sp[Sj]);else return Sp[Sj];}}}}});}else Sw=SR;const Sr={};Sr[J4(0x1c8)]=J4(0x17f),Sr['label']=SZ?SZ:z+J4(0x1e2),Sr[J4(0x1f0)]=Sw,Sr['borderColor']=J4(0x249),Sr[J4(0x22b)]=![],Sr[J4(0x193)]=r,Sr[J4(0x200)]=M,SJ[J4(0x1f0)][J4(0x1da)][J4(0x1cc)](Sr);const SM={};SM[J4(0x1e5)]=![];const SP={};SP[J4(0x1e5)]=![];const SO={};SO['x']=SM,SO['y']=SP,SJ[J4(0x20d)][J4(0x1a0)]=SO;}}const Se=document[J4(0x1ac)](J4(0x214));Se[J4(0x1d0)]('p')&&(Se['innerHTML']='');const Sx=document[J4(0x247)]('div');Sx[J4(0x1f8)]='chart-wrapper';const SI=document[J4(0x247)](J4(0x1e9));SI[J4(0x19a)]=J4(0x1c7),SI[J4(0x1f8)]=J4(0x1e8),SI['onclick']=function(){Sx['remove'](),delete chartConfigs[Sx['id']];},Sx[J4(0x209)](SI);if(K!=='scatter'&&K!==J4(0x215)){const Sj=document['createElement'](J4(0x1e9));Sj[J4(0x19a)]='Customize\x20Colors',Sj[J4(0x1f8)]=J4(0x220),Sj[J4(0x1a1)]=function(){openCustomColorModal(Sx['id']);},Sx['appendChild'](Sj);let d0=Date['now']();const d1=document[J4(0x247)](J4(0x16d));d1[J4(0x1f8)]=J4(0x234),d1[J4(0x177)][J4(0x23c)]=J4(0x1bf);const d2=document['createElement'](J4(0x1f1));d2[J4(0x19a)]=J4(0x213),d1[J4(0x209)](d2);const d3=document['createElement'](J4(0x1a2));d3['className']='form-select\x20form-select-sm',d3['id']=J4(0x24c)+d0;const d4=document[J4(0x247)]('option');d4[J4(0x21e)]='',d4[J4(0x240)]=J4(0x1fa),d3['appendChild'](d4),fields[J4(0x1c2)](d9=>{const JJ=J4,dS=document['createElement'](JJ(0x180));dS[JJ(0x21e)]=d9,dS[JJ(0x240)]=d9,d3[JJ(0x209)](dS);}),d1['appendChild'](d3);const d5=document['createElement']('div');d5['id']=J4(0x1f6)+d0,d5[J4(0x177)][J4(0x23c)]=J4(0x1bf),d1['appendChild'](d5),d3[J4(0x21a)]=function(){const Je=J4;let d9=d3['value'];updateSlicerButtons(d0,chartConfigs[Sx['id']][Je(0x218)]['baseData'],d9,Sx['id']);};const d6=document[J4(0x247)]('button');d6['type']=J4(0x1e9),d6[J4(0x1f8)]=J4(0x242),d6[J4(0x19a)]=J4(0x1d9),d6['onclick']=function(){applyChartSlicer(Sx['id']);},d1[J4(0x209)](d6);const d7=document[J4(0x247)](J4(0x1e9));d7[J4(0x1c8)]=J4(0x1e9),d7[J4(0x1f8)]='btn\x20btn-secondary\x20btn-sm\x20mt-1',d7[J4(0x19a)]=J4(0x1c5),d7[J4(0x1a1)]=function(){const Jx=J4;d1[Jx(0x177)]['display']=Jx(0x1bf),d8['style']['display']='inline-block';},d1[J4(0x209)](d7);const d8=document[J4(0x247)](J4(0x1e9));d8['innerText']=J4(0x23d),d8['className']=J4(0x173),d8[J4(0x177)][J4(0x1cf)]=J4(0x22f),d8[J4(0x1a1)]=function(){const JI=J4;d1['style'][JI(0x23c)]='block',d8[JI(0x177)][JI(0x23c)]=JI(0x1bf),Sx[JI(0x1ae)](d1);},Sx[J4(0x209)](d8);}const Sv=document[J4(0x247)](J4(0x16d));Sv[J4(0x1f8)]=J4(0x203);const Sh=document[J4(0x247)]('div');Sh[J4(0x1f8)]=J4(0x194);const SV=document[J4(0x247)](J4(0x1bb));Sh[J4(0x209)](SV);if(['bar','pie','doughnut',J4(0x18c),'mixed',J4(0x1a6),'polarArea',J4(0x211)]['includes'](K)){let d9=document[J4(0x247)](J4(0x16d));d9['className']='zoom-bar-container';const dS=document[J4(0x247)](J4(0x16d));dS[J4(0x1f8)]=J4(0x1ab);const dd=document[J4(0x247)]('span');dd[J4(0x1f8)]=J4(0x1d3),dd[J4(0x19a)]=J4(0x23e),dS[J4(0x209)](dd);const dJ=document[J4(0x247)]('input');dJ['type']=J4(0x22c),dJ[J4(0x1fe)]='1',dJ[J4(0x171)]='100',dJ[J4(0x21e)]=J4(0x1d2),dJ[J4(0x1f8)]=J4(0x24b),dJ[J4(0x177)][J4(0x18a)]='1';const de=document[J4(0x247)](J4(0x1c4));de[J4(0x1f8)]='input-group-text',de[J4(0x19a)]=J4(0x20a),dJ['oninput']=function(){const Jv=J4;let dI=parseInt(dJ['value']);de[Jv(0x19a)]=dI+'%',updateZoom(Sx['id'],dI);},dS[J4(0x209)](dJ),dS[J4(0x209)](de),d9[J4(0x209)](dS);const dx=document[J4(0x247)](J4(0x1e9));dx[J4(0x1c8)]=J4(0x1e9),dx[J4(0x1f8)]=J4(0x173),dx[J4(0x19a)]='Reset',dx[J4(0x1a1)]=function(){const Jh=J4;dJ['value']=Jh(0x1d2),de[Jh(0x19a)]=Jh(0x20a),updateZoom(Sx['id'],-0x2*0x5a6+-0x1f2d+-0x1*-0x2add);},d9[J4(0x209)](dx),Sv[J4(0x209)](Sh),Sv[J4(0x209)](d9);}else Sv[J4(0x209)](Sh);Sx[J4(0x209)](Sv),Se[J4(0x209)](Sx),Sx['id']=J4(0x227)+Date['now']();const SL={};SL[J4(0x1ed)]=T;const Sm={...SJ};Sm[J4(0x20d)]={...SJ['options']},Sm[J4(0x20d)][J4(0x16f)]=!![],Sm[J4(0x20d)][J4(0x1ee)]=![],Sm[J4(0x20d)][J4(0x1f5)]={...SJ[J4(0x20d)][J4(0x1f5)]},Sm[J4(0x20d)][J4(0x1f5)]['chartAreaBgPlugin']=SL;let Sq=new Chart(SV,Sm);const Sn={};Sn[J4(0x210)]=K,Sn['xField']=z,Sn[J4(0x18f)]=b,Sn[J4(0x170)]=Q,Sn[J4(0x1f3)]=B,Sn['chartTitle']=F,Sn['chartAreaBgColor']=T,Sn['baseData']=S6,Sn['currentData']=S6,Sn[J4(0x19d)]=Z,Sn[J4(0x178)]=w,Sn[J4(0x193)]=r,Sn['pointRadius']=M,Sn[J4(0x23a)]=P,Sn[J4(0x1dc)]=O,Sn[J4(0x225)]=p,Sn[J4(0x24a)]=k,Sn['yAxisFontColor']=j,Sn[J4(0x187)]=S0,Sn[J4(0x182)]=S1,Sn[J4(0x16a)]=S2,Sn['titleFontSize']=S3,Sn[J4(0x19c)]=S4,Sn[J4(0x17d)]=S5;let Ss=Sn;if(K!==J4(0x1ad)&&K!==J4(0x215)){let dI={};Q===J4(0x17c)?S6[J4(0x1c2)](dh=>{const JV=J4,dV=dh[z]||JV(0x1aa);if(!dI[dV])dI[dV]=-0xca0*-0x1+-0x1*0x830+0x1*-0x470;dI[dV]++;}):S6[J4(0x1c2)](dh=>{const JL=J4,dV=dh[z]||JL(0x1aa),dL=parseFloat(dh[b]);if(isNumeric(dL)){if(!dI[dV])dI[dV]=[];dI[dV][JL(0x1cc)](dL);}});let dv=Object[J4(0x244)](dI);Ss[J4(0x1b4)]=dv,Ss[J4(0x205)]=generateDefaultColors(dv[J4(0x21c)]);}const SE={};SE[J4(0x1d1)]=Sq,SE['params']=Ss,chartConfigs[Sx['id']]=SE;}  
</script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
